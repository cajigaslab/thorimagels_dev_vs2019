<UserControl x:Class="RunSampleLSDll.View.RunSampleLSView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ViewModel="clr-namespace:RunSampleLSDll.ViewModel"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:help="clr-namespace:HelpProvider;assembly=HelpProvider"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sample="clr-namespace:SampleRegionSelection;assembly=SampleRegionSelection"
             xmlns:tile="clr-namespace:TilesDisplay;assembly=TilesDisplay"
             xmlns:xy="clr-namespace:XYTileControl;assembly=XYTileControl"
             xmlns:dflimControl="clr-namespace:DFLIMControl;assembly=DFLIMControl"
             xmlns:View="clr-namespace:RunSampleLSModule.View"
             xmlns:Validator="clr-namespace:Validations;assembly=Validations"
             xmlns:System="clr-namespace:System;assembly=mscorlib"
             xmlns:ig="http://schemas.infragistics.com/xaml"
             FocusManager.FocusedElement="{Binding ElementName=btnStart}"
             IsEnabled="{Binding Path=PanelsEnable,
                                 Mode=OneWay,
                                 UpdateSourceTrigger=PropertyChanged}"
             help:Help.Filename="ThorImageLS.chm"
             help:Help.Keyword="Capture"
             mc:Ignorable="d">
    <UserControl.Resources>
        <ResourceDictionary>
            <DataTemplate DataType="{x:Type ViewModel:RunSampleLSViewModel}">
                <ListBox ItemsSource="{Binding Path=ObjectCollection}" />
            </DataTemplate>
            <ViewModel:CaptureModeStreamingToEnabledConverter x:Key="streamEnableConverter" />
            <ViewModel:CaptureModeZandTToEnabledConverter x:Key="ztEnableConverter" />
            <ViewModel:TriggerModeTimelapseEnableConverter x:Key="triggerTimelapseConverter" />
            <ViewModel:BooleanToVisibilityCustomConverter x:Key="boolToVisibilityConverter" />
            <ViewModel:BleachStreamEnableConverter x:Key="bleachStreamEnableConverter" />
            <ViewModel:StorageModeVisibilityConverter x:Key="storageModeVisibilityConverter" />
            <ViewModel:DoubleCultureConverter x:Key="doubleCulture" />
            <ViewModel:DoubleScaledCultureConverter x:Key="doubleCultureUnitConverter" />
            <ViewModel:BoolToOppositeBoolConverter x:Key="boolToOppositeBoolConverter" />
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/ThemeControl;component/ThorStyleDark.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <StackPanel Name="mainPanel">
            <Grid Margin="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <!--
                    <Rectangle d:LayoutOverrides="VerticalAlignment"
                    Fill="#FF333333"
                    Stroke="#FF000000"
                    Grid.RowSpan="6"
                    Grid.ColumnSpan="2"
                    Grid.Row="0"
                    Width="Auto"
                    RadiusX="12"
                    RadiusY="12"
                    StrokeThickness="0" />
                -->
                <StackPanel>
                    <StackPanel Margin="1"
                                IsEnabled="{Binding Path=StartButtonStatus,
                                                    Mode=OneWay,
                                                    UpdateSourceTrigger=PropertyChanged}"
                                Orientation="Horizontal"
                                ToolTip="Experiment Capture Mode">
                        <Label Content="Capture Mode" />
                        <ComboBox Name="cbCaptureMode"
                                  Width="200"
                                  PreviewKeyDown="cbCaptureMode_PreviewKeyDown"
                                  PreviewMouseWheel="cbCaptureMode_PreviewMouseWheel"
                                  SelectedIndex="{Binding Path=CaptureMode,
                                                          Mode=TwoWay,
                                                          UpdateSourceTrigger=PropertyChanged}"
                                  SelectionChanged="cbCaptureMode_SelectionChanged">
                            <ComboBoxItem Name="cbiZAndT">Z and T</ComboBoxItem>
                            <ComboBoxItem Name="cbiStreaming">Streaming</ComboBoxItem>
                            <ComboBoxItem Name="cbiTDI"
                                          Visibility="{Binding Path=TDIOptionsVisibility}">TDI</ComboBoxItem>
                            <ComboBoxItem Name="cbiBleaching"
                                          Visibility="{Binding Path=BleachOptionsVisibility}">Stimulation</ComboBoxItem>
                            <ComboBoxItem Name="cbiHyperspectral">Hyperspectral</ComboBoxItem>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Name="cameraUIPanel">
                        <GroupBox Name="cameraTimeGroup"
                                  Margin="1"
                                  IsEnabled="{Binding ElementName=cbCaptureMode,
                                                      Path=SelectedIndex,
                                                      Converter={StaticResource ztEnableConverter}}">
                            <GroupBox.Header>
                                <Label Content="Time Series" />
                            </GroupBox.Header>

                            <StackPanel Orientation="Horizontal">
                                <StackPanel ToolTip="Time Interval Between Timepoints (seconds)">
                                    <StackPanel Name="spCameraTimeTrigger"
                                                Margin="1"
                                                Orientation="Horizontal">
                                        <Label Margin="1"
                                               Content="Trigger Mode" />
                                        <ComboBox Name="cbCameraTimeTriggerModes"
                                                  Width="100"
                                                  SelectedIndex="{Binding Path=TriggerModeTimelapse,
                                                                          Mode=TwoWay,
                                                                          UpdateSourceTrigger=PropertyChanged}">
                                            <ComboBoxItem Content="None" />
                                            <ComboBoxItem Content="Trigger First" />
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel Margin="1"
                                                Orientation="Horizontal">
                                        <Label Width="120"
                                               Content="Interval" />
                                        <TextBox Name="txtTInterval"
                                                 Width="50"
                                                 Text="{Binding Path=TInterval,
                                                                Mode=TwoWay,
                                                                Converter={StaticResource doubleCulture}}" />
                                        <Grid>
                                            <Label Content="[sec]" />
                                            <Button Name="btnApply"
                                                    Width="50"
                                                    Content="Apply"
                                                    Visibility="{Binding ElementName=txtTInterval,
                                                                         Path=IsFocused,
                                                                         ConverterParameter=0,
                                                                         Converter={StaticResource boolToVisibilityConverter}}" />
                                        </Grid>
                                    </StackPanel>
                                    <StackPanel Margin="1"
                                                Orientation="Horizontal"
                                                ToolTip="Total Number of Timepoints">
                                        <Label Width="120"
                                               Content="Frames" />
                                        <TextBox Width="50"
                                                 Text="{Binding Path=TFrames, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <StackPanel Margin="1"
                                                Orientation="Horizontal"
                                                ToolTip="Estimated Total Time for Experiment">
                                        <Label Width="125"
                                               Content="Total Time HH:MM:SS" />
                                        <Label Width="120"
                                               HorizontalContentAlignment="Left"
                                               Content="{Binding Path=TTotalTime,
                                                                 Mode=OneWay,
                                                                 UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                </StackPanel>
                                <StackPanel>
                                    <StackPanel VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                        <TextBlock Margin="1"
                                                   HorizontalAlignment="Center"
                                                   FontSize="20"
                                                   Foreground="Lime"
                                                   Text="{Binding Path=CurrentTCount,
                                                                  Mode=OneWay,
                                                                  UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock Margin="1"
                                                   HorizontalAlignment="Center"
                                                   FontSize="20"
                                                   Foreground="Lime"
                                                   Text="/" />
                                        <TextBlock Margin="1"
                                                   HorizontalAlignment="Center"
                                                   FontSize="20"
                                                   Foreground="Lime"
                                                   Text="{Binding Path=TFrames,
                                                                  Mode=OneWay,
                                                                  UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                    <StackPanel>
                                        <WrapPanel MaxWidth="240"
                                                   Orientation="Horizontal"
                                                   Visibility="{Binding Path=StopButtonStatus,
                                                                        ConverterParameter=0,
                                                                        Converter={StaticResource boolToVisibilityConverter}}">
                                            <StackPanel Margin="3,0,3,0"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power0Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[0].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power0,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="20"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="3,0,3,0"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power1Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[1].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power1,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="20"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="3,0,3,0"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power2Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[2].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power2,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="20"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="3,0,3,0"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power3Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[3].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power3,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="20"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="3,0,3,0"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power4Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[4].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power4,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="20"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="3,0,3,0"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power5Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[5].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power5,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="20"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                        </WrapPanel>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                        <GroupBox Name="cameraStreamGroup"
                                  Margin="1"
                                  BorderBrush="White">
                            <GroupBox.Header>
                                <Label Content="Streaming" />
                            </GroupBox.Header>
                            <StackPanel IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel Margin="1"
                                            Orientation="Horizontal">
                                    <Label Width="150"
                                           Content="Number of Frames" />
                                    <TextBox Width="50"
                                             Text="{Binding Path=StreamFrames, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </StackPanel>
                                <StackPanel>
                                    <ComboBox Width="150"
                                              Height="30"
                                              Margin="1"
                                              HorizontalAlignment="Left"
                                              SelectedIndex="{Binding Path=RawDataCapture,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                              ToolTip="Choose Output Data Format">
                                        <ComboBoxItem>TIFF</ComboBoxItem>
                                        <ComboBoxItem>RAW</ComboBoxItem>
                                        <ComboBoxItem>OME TIFF</ComboBoxItem>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Name="spCamStreamTrigger"
                                            Margin="1"
                                            Orientation="Horizontal">
                                    <Label Margin="1"
                                           Content="Trigger Mode" />
                                    <ComboBox Name="cbCameraStreamTriggerModes"
                                              Width="100"
                                              SelectedIndex="{Binding Path=TriggerModeStreaming,
                                                                      Mode=TwoWay,
                                                                      UpdateSourceTrigger=PropertyChanged}"
                                              ToolTip="Enable/Disable External Trigger Input">
                                        <ComboBoxItem Content="None" />
                                        <ComboBoxItem Content="Trigger First" />
                                        <ComboBoxItem Content="Trigger Each" />
                                        <ComboBoxItem Content="Bulb Mode" />
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Margin="1"
                                            Orientation="Horizontal"
                                            ToolTip="Estimated Total Time for Experiment">
                                    <Label Width="120"
                                           Content="Total Time HH:MM:SS" />
                                    <Label Width="120"
                                           Content="{Binding Path=StreamTotalTime, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal"
                                            Visibility="{Binding StreamingAverageOptionsVisibility}" Margin="3">

                                    <CheckBox Content="Display Rolling Average"
                                              IsChecked="{Binding StreamingDisplayRollingAveragePreview}" VerticalAlignment="Center" />
                                    <Label Content="Average Frames"
                                           IsEnabled="{Binding StreamingDisplayRollingAveragePreview}"
                                           Margin="25,0,0,0" />
                                    <TextBox Width="50"
                                             Name="streamingAvgPreviewTB2"
                                             IsEnabled="{Binding StreamingDisplayRollingAveragePreview}"
                                             Text="{Binding LSMAverageNum}" />
                                    <Button Width="30"
                                            Content="✓">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Visibility"
                                                        Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=streamingAvgPreviewTB2}"
                                                                 Value="True">
                                                        <Setter Property="Visibility"
                                                                Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>
                                </StackPanel>
                                
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>

                    <StackPanel Name="groupPanel">
                        <GroupBox Name="zStackGroup"
                                  Margin="1"
                                  BorderBrush="White"
                                  IsEnabled="{Binding ElementName=cbCaptureMode,
                                                      Path=SelectedIndex,
                                                      Converter={StaticResource ztEnableConverter}}"
                                  Visibility="{Binding Path=ZOptionsVisibility}">
                            <GroupBox.Header>
                                <CheckBox x:Name="cbZEnable"
                                          IsChecked="{Binding Path=ZEnable,
                                                              Mode=TwoWay,
                                                              UpdateSourceTrigger=PropertyChanged}"
                                          ToolTip="Enable/Disable Z Stack Capture"
                                          IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                                    <Label Content="Z Stack" />
                                </CheckBox>
                            </GroupBox.Header>
                            <StackPanel Orientation="Vertical">
                                <StackPanel IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                            Orientation="Horizontal">
                                    <StackPanel IsEnabled="{Binding ElementName=cbZEnable, Path=IsChecked}"
                                                Orientation="Horizontal">
                                        <StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Stack Start Position">
                                                <Label Width="130"
                                                       Content="{Binding ZStartPositionLabel}" />
                                                <TextBox Name="tbZStartPosition"
                                                         Width="50"
                                                         Text="{Binding ZStartPosition, ConverterParameter=1000, Converter={StaticResource doubleCultureUnitConverter}, Mode=TwoWay}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbZStartPosition}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Label Width="80"
                                                       Content="[um]"
                                                       Visibility="{Binding Path=IsRemoteFocus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource boolToVisibilityConverter}, ConverterParameter=1}"/>
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Stack Stop Position">
                                                <Label Width="130"
                                                       Content="{Binding ZStopPositionLabel}" />
                                                <TextBox Name="tbZStopPosition"
                                                         Width="50"
                                                         Foreground="White"
                                                         Text="{Binding Path=ZStopPosition,
                                                                        Mode=TwoWay,
                                                                        ConverterParameter=1000,
                                                                        Converter={StaticResource doubleCultureUnitConverter}}">
                                                    <TextBox.Style>
                                                        <Style TargetType="TextBox">
                                                            <Style.Resources>
                                                                <Storyboard x:Key="flashingAnimation">
                                                                    <DoubleAnimation AutoReverse="True"
                                                                                     Duration="0:0:0.5"
                                                                                     From="1"
                                                                                     RepeatBehavior="Forever"
                                                                                     Storyboard.TargetProperty="(Background).(Opacity)"
                                                                                     To="0.5" />
                                                                </Storyboard>
                                                            </Style.Resources>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=ZStopPositionNotValid}"
                                                                             Value="True">
                                                                    <Setter Property="Background"
                                                                            Value="Red" />
                                                                    <DataTrigger.EnterActions>
                                                                        <BeginStoryboard Name="flashing"
                                                                                         Storyboard="{StaticResource flashingAnimation}" />
                                                                    </DataTrigger.EnterActions>
                                                                    <DataTrigger.ExitActions>
                                                                        <StopStoryboard BeginStoryboardName="flashing" />
                                                                    </DataTrigger.ExitActions>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding Path=ZStopPositionNotValid, UpdateSourceTrigger=PropertyChanged}"
                                                                             Value="False">
                                                                    <Setter Property="Background"
                                                                            Value="Transparent" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBox.Style>
                                                </TextBox>
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbZStopPosition}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Label Width="80"
                                                       Content="[um]"
                                                       Visibility="{Binding Path=IsRemoteFocus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource boolToVisibilityConverter}, ConverterParameter=1}"/>
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        ToolTip="Z Slice Spacing"
                                                        Orientation="Horizontal">
                                                <Label Width="130"
                                                       Content="Step Size" />
                                                <TextBox Name="tbZStepSize"
                                                         Width="50"
                                                         Text="{Binding Path=ZStepSize,
                                                                        Mode=TwoWay,
                                                                        Converter={StaticResource doubleCulture}}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbZStepSize}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Label Width="80"
                                                       Content="[um]" 
                                                       Visibility="{Binding Path=IsRemoteFocus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource boolToVisibilityConverter}, ConverterParameter=1}"/>
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Total Number of Z Slices">
                                                <Label Width="130"
                                                       Content="Number of Slices" />
                                                <Label Width="50"
                                                       Content="{Binding Path=ZNumSteps, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />

                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        IsEnabled="True"
                                                        Orientation="Horizontal">
                                                <CheckBox Name="cbZSEnable"
                                                          IsChecked="{Binding Path=ZStreamEnable,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged}"
                                                          ToolTip="Enable Streaming for Each Z Location">
                                                    <Label Content="Enable Z Streaming" />
                                                </CheckBox>
                                                <TextBox Name="tbZStreamFrame"
                                                         Width="50"
                                                         IsEnabled="{Binding Path=ZStreamEnable,
                                                                             Mode=OneWay,
                                                                             UpdateSourceTrigger=PropertyChanged}"
                                                         Text="{Binding Path=ZStreamFrames,
                                                                        Mode=TwoWay}"
                                                         ToolTip="Frames to stream" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbZStreamFrame}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Label Width="80"
                                                       Content="Frames" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        IsEnabled="True"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=ZFileVisibility,
                                                                            Mode=OneWay,
                                                                            UpdateSourceTrigger=PropertyChanged}">
                                                <CheckBox Name="cbZFileEnable"
                                                        Width="130"
                                                        IsChecked="{Binding Path=ZFileEnable,
                                                                            Mode=TwoWay,
                                                                            UpdateSourceTrigger=PropertyChanged}"
                                                        ToolTip="Read list of Z positions from file">
                                                    <Label Content="Read from File" />
                                                </CheckBox>
                                                <Label Content="Conversion Factor:" />
                                                <TextBox Name="tbZFilePosScale"
                                                        Width="50"
                                                        IsEnabled="{Binding Path=ZFileEnable,
                                                                            Mode=OneWay,
                                                                            UpdateSourceTrigger=PropertyChanged}"
                                                        Text="{Binding Path=ZFilePosScale,
                                                                       Converter={StaticResource doubleCulture},
                                                                       Mode=TwoWay}"
                                                        ToolTip="Scale factor to apply to file content" />
                                                <Button Width="30"
                                                      Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbZFilePosScale}"
                                                                    Value="True">
                                                                    <Setter Property="Visibility"
                                                                Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                        </StackPanel>
                                        <!--
                                            <StackPanel Orientation="Horizontal"
                                            Margin="1"
                                            IsEnabled="True">
                                            <CheckBox
                                            Name = "cbZSEnable"
                                            IsChecked="{Binding Path=ZStreamEnable, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            ToolTip="Enable Streaming for Each Z Location">
                                            <Label Content="Enable Z Streaming"
                                            Foreground="White" />
                                            </CheckBox>
                                            <TextBox Name ="tbZStreamFrame"
                                            Width="50"
                                            Text="{Binding Path=ZStreamFrames, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                                            <Label Width="120"
                                            Content=" Frames"
                                            ></Label>
                                            
                                            </StackPanel>
                                        -->
                                        <StackPanel VerticalAlignment="Center">
                                            <StackPanel Orientation="Horizontal"
                                                        Visibility="{Binding Path=StopButtonStatus, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}">
                                                <Label MinWidth="75"
                                                       Margin="1"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Content="{Binding Path=ZPosition,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged,
                                                                         ConverterParameter=1000,
                                                                         Converter={StaticResource doubleCultureUnitConverter}}"
                                                       FontSize="20"
                                                       Foreground="Lime" />
                                                <Label Margin="1"
                                                       HorizontalAlignment="Center"
                                                       Content="[um]"
                                                       FontSize="20"
                                                       Foreground="Lime" />

                                            </StackPanel>
                                            <StackPanel VerticalAlignment="Center"
                                                        Orientation="Horizontal">
                                                <TextBlock Margin="1"
                                                           HorizontalAlignment="Center"
                                                           FontSize="20"
                                                           Foreground="Lime"
                                                           Text="{Binding Path=CurrentZCount,
                                                                          Mode=OneWay,
                                                                          UpdateSourceTrigger=PropertyChanged}" />
                                                <TextBlock Margin="1"
                                                           HorizontalAlignment="Center"
                                                           FontSize="20"
                                                           Foreground="Lime"
                                                           Text="/" />
                                                <TextBlock Margin="1"
                                                           HorizontalAlignment="Center"
                                                           FontSize="20"
                                                           Foreground="Lime"
                                                           Text="{Binding Path=ZNumSteps,
                                                                          Mode=OneWay,
                                                                          UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                            <StackPanel>
                                                <WrapPanel MaxWidth="240"
                                                           Orientation="Horizontal"
                                                           Visibility="{Binding Path=StopButtonStatus,
                                                                                ConverterParameter=0,
                                                                                Converter={StaticResource boolToVisibilityConverter}}">
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=Power0Visibility}">
                                                        <Label Content="{Binding Path=PowerControlNames[0].Value}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content=":"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=Power0,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=Power1Visibility}">
                                                        <Label Content="{Binding Path=PowerControlNames[1].Value}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content=":"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=Power1,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=Power2Visibility}">
                                                        <Label Content="{Binding Path=PowerControlNames[2].Value}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content=":"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=Power2,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=Power3Visibility}">
                                                        <Label Content="{Binding Path=PowerControlNames[3].Value}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content=":"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=Power3,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=Power4Visibility}">
                                                        <Label Content="{Binding Path=PowerControlNames[4].Value}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content=":"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=Power4,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=Power5Visibility}">
                                                        <Label Content="{Binding Path=PowerControlNames[5].Value}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content=":"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=Power5,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=MCLS1Visibility}">
                                                        <Label Content="{Binding Path=MCLS1Name}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=MCLS1Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=MCLS2Visibility}">
                                                        <Label Content="{Binding Path=MCLS2Name}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=MCLS2Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=MCLS3Visibility}">
                                                        <Label Content="{Binding Path=MCLS3Name}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=MCLS3Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=MCLS4Visibility}">
                                                        <Label Content="{Binding Path=MCLS4Name}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="{Binding Path=MCLS4Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                    </StackPanel>
                                                    <StackPanel Margin="1"
                                                                Orientation="Horizontal"
                                                                Visibility="{Binding Path=PinholeVisibility}">
                                                        <Label Content="Pinhole:"
                                                               FontSize="14"
                                                               Foreground="LimeGreen" />
                                                        <Label Content="{Binding Path=PinholePosition,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                               FontSize="14"
                                                               Foreground="Lime" />
                                                        <Label Content="[um]"
                                                               FontSize="14"
                                                               Foreground="LimeGreen" />
                                                    </StackPanel>
                                                </WrapPanel>
                                            </StackPanel>
                                        </StackPanel>
                                        <!--
                                            <Grid Width="60"
                                            Height="100"
                                            Margin="1">
                                            <ProgressBar Orientation="Vertical"
                                            Value="{Binding Path=CurrentZCount, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                            Minimum="0"
                                            Maximum="{Binding Path=ZNumSteps, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"></ProgressBar>
                                            <Viewbox>
                                            <TextBlock Text="{Binding Path=CurrentZCount, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                            HorizontalAlignment="Center"
                                            Margin="0,70,0,0"></TextBlock>
                                            </Viewbox>
                                            </Grid>
                                        -->
                                    </StackPanel>
                                </StackPanel>

                            </StackPanel>
                        </GroupBox>
                        <GroupBox Name="timeGroup"
                                  Margin="1"
                                  BorderBrush="White"
                                  IsEnabled="{Binding ElementName=cbCaptureMode,
                                                      Path=SelectedIndex,
                                                      Converter={StaticResource ztEnableConverter}}">
                            <GroupBox.Header>
                                <CheckBox x:Name="cbTEnable"
                                          IsChecked="{Binding Path=TEnable,
                                                              Mode=TwoWay,
                                                              UpdateSourceTrigger=PropertyChanged}"
                                          ToolTip="Enable/Disable Time Series Capture"
                                          IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                                    <Label Content="Time Series" />
                                </CheckBox>
                            </GroupBox.Header>
                            <StackPanel IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                        Orientation="Horizontal">
                                <StackPanel IsEnabled="{Binding ElementName=cbTEnable, Path=IsChecked}">
                                    <StackPanel Name="spTimeTrigger"
                                                Margin="1"
                                                Orientation="Horizontal"
                                                ToolTip="Trigger Mode for arming Image Detector">
                                        <Label Margin="1"
                                               Content="Trigger Mode" />
                                        <ComboBox Name="cbTimeTriggerModes"
                                                  Width="100"
                                                  SelectedIndex="{Binding Path=TriggerModeTimelapse,
                                                                          Mode=TwoWay,
                                                                          UpdateSourceTrigger=PropertyChanged}">
                                            <ComboBoxItem Content="None" />
                                            <ComboBoxItem Content="Trigger First" />
                                            <ComboBoxItem Content="Trigger Each" />
                                        </ComboBox>
                                    </StackPanel>
                                    <StackPanel Margin="1"
                                                Orientation="Horizontal"
                                                ToolTip="Time Interval Between Timepoints (seconds)">
                                        <Label Width="120"
                                               Content="Interval" />
                                        <TextBox Name="tbTInterval"
                                                 Width="50"
                                                 IsEnabled="{Binding Path=TriggerModeTimelapse,
                                                                     Converter={StaticResource triggerTimelapseConverter}}"
                                                 Text="{Binding Path=TInterval,
                                                                Mode=TwoWay,
                                                                Converter={StaticResource doubleCulture}}" />
                                        <Button Width="30"
                                                Content="✓">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbTInterval}"
                                                                     Value="True">
                                                            <Setter Property="Visibility"
                                                                    Value="Visible" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                        <Label Width="120"
                                               Content="[sec]" />
                                    </StackPanel>
                                    <StackPanel Margin="1"
                                                Orientation="Horizontal"
                                                ToolTip="Total Number of Timepoints">
                                        <Label Width="120"
                                               Content="Frames" />
                                        <TextBox Name="tbTFrames"
                                                 Width="50"
                                                 Text="{Binding Path=TFrames,
                                                                Mode=TwoWay}" />
                                        <Button Width="30"
                                                Content="✓">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbTFrames}"
                                                                     Value="True">
                                                            <Setter Property="Visibility"
                                                                    Value="Visible" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </StackPanel>
                                    <StackPanel Margin="1"
                                                Orientation="Horizontal"
                                                ToolTip="Estimated Total Time for Experiment">
                                        <Label Width="125"
                                               Content="Total Time HH:MM:SS" />
                                        <Label Width="120"
                                               HorizontalContentAlignment="Left"
                                               Content="{Binding Path=TTotalTime,
                                                                 Mode=OneWay,
                                                                 UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>

                                </StackPanel>
                                <StackPanel>
                                    <StackPanel VerticalAlignment="Center"
                                                Orientation="Horizontal">
                                        <TextBlock Margin="1"
                                                   HorizontalAlignment="Center"
                                                   FontSize="20"
                                                   Foreground="Lime"
                                                   Text="{Binding Path=CurrentTCount,
                                                                  Mode=OneWay,
                                                                  UpdateSourceTrigger=PropertyChanged}" />
                                        <TextBlock Margin="1"
                                                   HorizontalAlignment="Center"
                                                   FontSize="20"
                                                   Foreground="Lime"
                                                   Text="/" />
                                        <TextBlock Margin="1"
                                                   HorizontalAlignment="Center"
                                                   FontSize="20"
                                                   Foreground="Lime"
                                                   Text="{Binding Path=TFrames,
                                                                  Mode=OneWay,
                                                                  UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Name="streamGroup"
                                  Margin="1"
                                  BorderBrush="White"
                                  IsEnabled="{Binding ElementName=cbCaptureMode,
                                                      Path=SelectedIndex,
                                                      Converter={StaticResource streamEnableConverter}}">
                            <GroupBox.Header>
                                <Label Content="Streaming" />
                            </GroupBox.Header>
                            <StackPanel IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">

                                <StackPanel Orientation="Horizontal">
                                    <ComboBox Name="cbStorageModes"
                                              Width="150"
                                              Height="30"
                                              Margin="1"
                                              HorizontalAlignment="Left"
                                              SelectedIndex="{Binding Path=StreamStorageMode,
                                                                      Mode=TwoWay,
                                                                      UpdateSourceTrigger=PropertyChanged}"
                                              SelectionChanged="cbStorageModes_SelectionChanged">
                                        <ComboBoxItem>Finite</ComboBoxItem>
                                        <ComboBoxItem>Stimulus</ComboBoxItem>
                                    </ComboBox>
                                    <Label Width="95"
                                           Margin="50,010,5,0"
                                           Content="Time HH:MM:SS" />
                                    <Label Margin="20,10,0,0"
                                           Content="Avg. Frames:" />
                                    <Label Margin="0,10,5,0"
                                           Content="{Binding Path=AvgFrames, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <StackPanel>
                                        <StackPanel Visibility="{Binding Path=StreamStorageMode, Mode=OneWay, ConverterParameter=0, Converter={StaticResource storageModeVisibilityConverter}}">
                                            <StackPanel Orientation="Horizontal">
                                                <StackPanel Margin="1"
                                                            Orientation="Horizontal"
                                                            ToolTip="Total Frames for Streaming Capture"
                                                            Visibility="{Binding Path=ZFastEnable,
                                                                                 Mode=OneWay,
                                                                                 ConverterParameter=1,
                                                                                 Converter={StaticResource boolToVisibilityConverter}}">
                                                    <Label Width="150"
                                                           Content="Number of Frames" />
                                                    <TextBox Name="tbStreamFrames"
                                                             Width="50"
                                                             Text="{Binding Path=StreamFrames,
                                                                            Mode=TwoWay}" />
                                                    <Button Width="30"
                                                            Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbStreamFrames}"
                                                                                 Value="True">
                                                                        <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal"
                                                            ToolTip="Time that the system will take to capture the entered Number of Frames"
                                                            Visibility="{Binding Path=ZFastEnable,
                                                                                 Mode=OneWay,
                                                                                 ConverterParameter=1,
                                                                                 Converter={StaticResource boolToVisibilityConverter}}">
                                                    <Label Width="55"
                                                           Margin="20,3,0,3"
                                                           Content="{Binding Path=StreamFramesTime,
                                                                             Mode=OneWay,
                                                                             UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                        Visibility="{Binding Path=ZFastEnable, Mode=OneWay, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}">
                                                <StackPanel Margin="1"
                                                            Orientation="Horizontal"
                                                            ToolTip="Total Volumes for Streaming Capture">
                                                    <Label Width="150"
                                                           Content="Number of Volumes" />
                                                    <TextBox Name="tbStreamVolumes"
                                                             Width="50"
                                                             Text="{Binding Path=StreamVolumes,
                                                                            Mode=TwoWay}" />
                                                    <Button Width="30"
                                                            Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbStreamVolumes}"
                                                                                 Value="True">
                                                                        <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal"
                                                            ToolTip="Time that the system will take to capture the entered Number of Volumes">
                                                    <Label Width="55"
                                                           Margin="20,3,0,3"
                                                           Content="{Binding Path=StreamFramesTime,
                                                                             Mode=OneWay,
                                                                             UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal"
                                                    Visibility="{Binding Path=StreamStorageMode, Mode=OneWay, ConverterParameter=1, Converter={StaticResource storageModeVisibilityConverter}}">
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Cycle frames for Stimulus Capture">
                                                <Label Width="150"
                                                       Content="Max Frames per Stimulus" />
                                                <TextBox Name="tbStimulusMaxFrames"
                                                         Width="50"
                                                         Text="{Binding Path=StimulusMaxFrames,
                                                                        Mode=TwoWay}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbStimulusMaxFrames}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                        ToolTip="Time that the system will take to capture the entered Max Frames per Stimulus">
                                                <Label Width="55"
                                                       Margin="20,3,0,3"
                                                       Content="{Binding Path=StimulusMaxFramesTime,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="RAM Frames for Streaming Capture"
                                                        Visibility="{Binding Path=DMAFramesVisibility,
                                                                             Mode=OneWay,
                                                                             ConverterParameter=1,
                                                                             Converter={StaticResource storageModeVisibilityConverter}}">
                                                <Label Width="150"
                                                       Content="RAM Frames" />
                                                <TextBox Name="tbRAMFrames"
                                                         Width="50"
                                                         Text="{Binding Path=DMAFrames,
                                                                        Mode=TwoWay}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbRAMFrames}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                        ToolTip="Time that the system will take to capture the entered RAM Frames">
                                                <Label Width="55"
                                                       Margin="20,3,0,3"
                                                       Content="{Binding Path=DMAFramesTime,
                                                                         Mode=OneWay,
                                                                         UpdateSourceTrigger=PropertyChanged}" />
                                            </StackPanel>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal"
                                                    Margin="1"
                                                    Visibility="{Binding Path=TimeBasedLineScanVisibility,
                                                                         Mode=TwoWay, 
                                                                         UpdateSourceTrigger=PropertyChanged}">
                                            <Label Content="Time Based Line Scan"
                                                   Width="150"/>
                                            <Label Content="{Binding Path=TimeBasedLSTimeMS}"
                                                   Width="50"/>
                                            <TextBox Name="tbTimeBasedLSTimeMS"
                                                     Width="50"
                                                     Visibility="Collapsed"
                                                     Text="{Binding Path=TimeBasedLSTimeMS,
                                                                    Mode=TwoWay}" />
                                            <Button Width="30"
                                                    Content="✓">
                                                <Button.Style>
                                                    <Style TargetType="Button">
                                                        <Setter Property="Visibility"
                                                                Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbTimeBasedLSTimeMS}"
                                                                         Value="True">
                                                                <Setter Property="Visibility"
                                                                        Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>
                                            <Label Content="[ms]" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <StackPanel>
                                                <ComboBox Name="cbStreamingCaptureDataType"
                                                          Width="150"
                                                          Height="30"
                                                          Margin="1"
                                                          HorizontalAlignment="Left"
                                                          SelectedIndex="{Binding Path=RawDataCapture,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                          ToolTip="Choose Output Data Format">
                                                    <ComboBoxItem>TIFF</ComboBoxItem>
                                                    <ComboBoxItem>RAW</ComboBoxItem>
                                                    <ComboBoxItem>OME TIFF</ComboBoxItem>
                                                </ComboBox>
                                                <CheckBox Name="chbExtStimulusTrig"
                                                          Margin="5,0,0,0"
                                                          IsChecked="{Binding Path=StimulusTriggering,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged}"
                                                          ToolTip="Enable/Disable Stimulus Triggering"
                                                          Visibility="Collapsed">
                                                    <Label Content="External Stimulus Triggering" />
                                                    <!--  Visibility ="{Binding Path=StreamStorageMode, Mode=OneWay, ConverterParameter=1, Converter={StaticResource storageModeVisibilityConverter}}"  -->
                                                </CheckBox>
                                            </StackPanel>
                                            <TextBlock Width="200"
                                                       Margin="1"
                                                       FontSize="24"
                                                       Foreground="Lime"
                                                       Text="{Binding Path=CurrentTCount,
                                                                      Mode=OneWay,
                                                                      UpdateSourceTrigger=PropertyChanged}"
                                                       TextAlignment="Right"
                                                       Visibility="{Binding Path=StreamStorageMode,
                                                                            Mode=OneWay,
                                                                            ConverterParameter=1,
                                                                            Converter={StaticResource storageModeVisibilityConverter}}" />
                                        </StackPanel>
                                        <StackPanel Name="spStreamTrigger"
                                                    Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=StreamStorageMode,
                                                                         Mode=OneWay,
                                                                         ConverterParameter=0,
                                                                         Converter={StaticResource storageModeVisibilityConverter}}">
                                            <Label Margin="1"
                                                   Content="Trigger Mode" />
                                            <ComboBox Name="cbStreamTriggerModes"
                                                      Width="100"
                                                      SelectedIndex="{Binding Path=TriggerModeStreaming,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged}"
                                                      ToolTip="Enable/Disable External Trigger Input">
                                                <ComboBoxItem Content="None" />
                                                <ComboBoxItem Content="Trigger First" />
                                            </ComboBox>
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    ToolTip="Estimated Total Time for Experiment"
                                                    Visibility="{Binding Path=StreamStorageMode,
                                                                         Mode=OneWay,
                                                                         ConverterParameter=0,
                                                                         Converter={StaticResource storageModeVisibilityConverter}}">
                                            <Label Width="120"
                                                   Content="Total Time HH:MM:SS" />
                                            <Label Width="120"
                                                   Content="{Binding Path=StreamTotalTime, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                        </StackPanel>
                                    </StackPanel>
                                    <StackPanel  MaxWidth="240"
                                                 Orientation="Horizontal"
                                                 Visibility="{Binding Path=StopButtonStatus,
                                                                    ConverterParameter=0,
                                                                    Converter={StaticResource boolToVisibilityConverter}}">
                                        <StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power0Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[0].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power0,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power1Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[1].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power1,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power2Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[2].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power2,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power3Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[3].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power3,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power4Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[4].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power4,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=Power5Visibility}">
                                                <Label Content="{Binding Path=PowerControlNames[5].Value}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content=":"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=Power5,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                        </StackPanel>
                                        <StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=MCLS1Visibility}">
                                                <Label Content="{Binding Path=MCLS1Name}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=MCLS1Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=MCLS2Visibility}">
                                                <Label Content="{Binding Path=MCLS2Name}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=MCLS2Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=MCLS3Visibility}">
                                                <Label Content="{Binding Path=MCLS3Name}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=MCLS3Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                            <StackPanel Margin="1"
                                                        Orientation="Horizontal"
                                                        Visibility="{Binding Path=MCLS4Visibility}">
                                                <Label Content="{Binding Path=MCLS4Name}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                                <Label Content="{Binding Path=MCLS4Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                       FontSize="14"
                                                       Foreground="Lime" />
                                            </StackPanel>
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=PinholeVisibility}">
                                            <Label Content="Pinhole:"
                                                   FontSize="14"
                                                   Foreground="LimeGreen" />
                                            <Label Content="{Binding Path=PinholePosition,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="[um]"
                                                   FontSize="14"
                                                   Foreground="LimeGreen" />
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal"
                                            IsEnabled="{Binding ElementName=cbZFastEnable, Path=IsChecked, Converter={StaticResource boolToOppositeBoolConverter}}"
                                            Visibility="{Binding StreamingAverageOptionsVisibility}"
                                            Margin="3">

                                    <CheckBox Content="Display Rolling Average"
                                              IsChecked="{Binding StreamingDisplayRollingAveragePreview}"
                                              VerticalAlignment="Center" />
                                    <Label Content="Average Frames"
                                           IsEnabled="{Binding StreamingDisplayRollingAveragePreview}"
                                           Margin="25,0,0,0" />
                                    <TextBox Width="50" Name="streamingAvgPreviewTB"
                                             IsEnabled="{Binding StreamingDisplayRollingAveragePreview}"
                                             Text="{Binding LSMAverageNum}" />
                                    <Button Width="30"
                                            Content="✓">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Visibility"
                                                        Value="Collapsed" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=streamingAvgPreviewTB}"
                                                                 Value="True">
                                                        <Setter Property="Visibility"
                                                                Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                    </Button>

                                </StackPanel>
                               
                                <GroupBox Name="groupBoxFastZ"
                                          Height="Auto"
                                          Margin="1">
                                    <GroupBox.Header>
                                        <CheckBox Content="Fast Z"
                                                  Foreground="White"
                                                  Name="cbZFastEnable"
                                                  IsChecked="{Binding Path=ZFastEnable,
                                                                      Mode=TwoWay,
                                                                      UpdateSourceTrigger=PropertyChanged}" />
                                    </GroupBox.Header>
                                    <StackPanel>
                                        <Grid Visibility="{Binding Path=IsRemoteFocus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource boolToVisibilityConverter}, ConverterParameter=1}">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0"
                                                    IsEnabled="{Binding ElementName=cbZFastEnable, Path=IsChecked}">
                                                <StackPanel Grid.Row="0"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Stack Start Position">
                                                    <Label Width="120"
                                                       Content="Start Position" />
                                                    <TextBox Name="tb2ZStartPosition"
                                                         Width="50"
                                                         Text="{Binding Path=ZStartPosition,
                                                                    Mode=TwoWay,
                                                                    ConverterParameter=1000,
                                                                    Converter={StaticResource doubleCultureUnitConverter}}" />
                                                    <Button Width="30"
                                                        Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tb2ZStartPosition}"
                                                                             Value="True">
                                                                        <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                    <Label Width="50"
                                                       Content="[um]" />
                                                </StackPanel>
                                                <StackPanel Grid.Row="1"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Stack Stop Position">
                                                    <Label Width="120"
                                                       Content="Stop Position" />
                                                    <TextBox Name="tb2ZStopPosition"
                                                         Width="50"
                                                         Text="{Binding Path=ZStopPosition,
                                                                    Mode=TwoWay,                                                                            ConverterParameter=1000,
                                                                    Converter={StaticResource doubleCultureUnitConverter}}" />
                                                    <Button Width="30"
                                                        Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tb2ZStopPosition}"
                                                                             Value="True">
                                                                        <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                    <Label Width="50"
                                                       Content="[um]" />
                                                </StackPanel>
                                                <StackPanel Grid.Row="2"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Slice Spacing">
                                                    <Label Width="120"
                                                       Content="Step Size" />
                                                    <TextBox Name="tb2ZStepSize"
                                                         Width="50"
                                                         Text="{Binding Path=ZStepSize,
                                                                    Mode=TwoWay,
                                                                    Converter={StaticResource doubleCulture}}" />
                                                    <Button Width="30"
                                                        Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tb2ZStepSize}"
                                                                             Value="True">
                                                                        <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                    <Label Width="50"
                                                       Content="[um]" />
                                                </StackPanel>
                                                <StackPanel Grid.Row="3"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Flyback Frames">
                                                    <Label Width="120"
                                                       Content="Flyback Frames" />
                                                    <TextBox Name="tbFlybackFrames"
                                                         Width="50"
                                                         Text="{Binding Path=FlybackFrames, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"
                                                         Validator:Validation.ValidationType="{x:Type System:Int32}"
                                                         Validator:Validation.NoEmptyValue="True"
                                                         Validator:Validation.MinValue="0"
                                                         Validator:InputBindingsManager.UpdatePropertySourceWhenEnterPressed="TextBox.Text" />
                                                    <Button Width="30"
                                                        Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbFlybackFrames}"
                                                                             Value="True">
                                                                        <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </StackPanel>
                                                <StackPanel Grid.Row="4"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Transition Cycles"
                                                        Visibility="{Binding Path=IsChecked, ElementName=ckbStaircase, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}">
                                                    <Label Width="120"
                                                       Content="Transition Cycles" />
                                                    <TextBox Name="tbFlybackLines"
                                                         Width="50"
                                                         Text="{Binding Path=FlybackLines, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"
                                                         Validator:Validation.ValidationType="{x:Type System:Int32}"
                                                         Validator:Validation.NoEmptyValue="True"
                                                         Validator:Validation.MinValue="0"
                                                         Validator:InputBindingsManager.UpdatePropertySourceWhenEnterPressed="TextBox.Text" />
                                                    <Button Width="30"
                                                        Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbFlybackLines}"
                                                                             Value="True">
                                                                        <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                    <Label Content="{Binding Path=LSMFlybackTime}"
                                                       VerticalAlignment="Center" />
                                                    <Label Content="[s]"
                                                       VerticalAlignment="Center" />
                                                </StackPanel>
                                                <StackPanel Grid.Row="5"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Total Number of Z Slices">
                                                    <Label Width="120"
                                                       Content="Number of Slices" />
                                                    <Label Width="50"
                                                       Content="{Binding Path=ZNumSteps, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                                <StackPanel Grid.Row="6"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Slice to Show in Preview">
                                                    <Label Width="120"
                                                       Content="Preview Index" />
                                                    <TextBox x:Name="tbPreviewIndex"
                                                         Width="50"
                                                         Text="{Binding Path=PreviewIndex,
                                                                    Mode=TwoWay}" />
                                                    <Button Width="30"
                                                        Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="{x:Type Button}">
                                                                <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsFocused, ElementName=tbPreviewIndex}"
                                                                             Value="True">
                                                                        <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                </StackPanel>
                                                <StackPanel Grid.Row="7"
                                                        Orientation="Horizontal">
                                                    <CheckBox Content="Use reference voltage to control pockels"
                                                          Visibility="{Binding Path=PockelsOutputReferenceVisibility}"
                                                          VerticalAlignment="Center"
                                                          Margin="5"
                                                          IsChecked="{Binding Path=UseReferenceVoltageForFastZPockels}" />
                                                </StackPanel>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1"
                                                    Orientation="Vertical"
                                                    IsEnabled="{Binding ElementName=cbZFastEnable, Path=IsChecked}">
                                                <!-- first three rows are empty labels -->
                                                <StackPanel Grid.Row="0"
                                                        Orientation="Horizontal"
                                                        Margin="1">
                                                    <CheckBox Name="ckbStaircase"
                                                          Content="Staircase Mode"
                                                          VerticalAlignment="Center"
                                                          Margin="5"
                                                          IsChecked="{Binding Path=FastZStaircase, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                                <StackPanel Grid.Row="1"
                                                        Margin="1">
                                                    <Label Width="50"
                                                       Content="" />
                                                </StackPanel>
                                                <StackPanel Name="stackPanelVolumeTimeAdjustment"
                                                        Grid.Row="2"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Volume Time Adjustment in msec, positive or negative.">
                                                    <StackPanel Orientation="Horizontal"
                                                            Visibility="{Binding Path=IsChecked, ElementName=ckbStaircase, ConverterParameter=1, Converter={StaticResource boolToVisibilityConverter}}">
                                                        <Label Width="150"
                                                           Content="Volume Time Adjustment" />
                                                        <TextBox Name="tbVolumeTimeAdjust"
                                                             Width="50"
                                                             Text="{Binding Path=VolumeTimeAdjustMS, Mode=TwoWay, UpdateSourceTrigger=LostFocus,NotifyOnValidationError=True,ValidatesOnDataErrors=True}"
                                                             Validator:Validation.ValidationType="{x:Type System:Double}"
                                                             Validator:Validation.NoEmptyValue="True"
                                                             Validator:InputBindingsManager.UpdatePropertySourceWhenEnterPressed="TextBox.Text" />
                                                        <Button Width="30"
                                                            Content="✓">
                                                            <Button.Style>
                                                                <Style TargetType="Button">
                                                                    <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbVolumeTimeAdjust}"
                                                                                 Value="True">
                                                                            <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Button.Style>
                                                        </Button>
                                                        <Label Width="50"
                                                           Content="[ms]" />
                                                    </StackPanel>
                                                    <StackPanel Orientation="Horizontal"
                                                            Visibility="{Binding Path=IsChecked, ElementName=ckbStaircase, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}">
                                                        <Label Width="150"
                                                           Content="  Frame Time Adjustment" />
                                                        <TextBox Name="tbStepTimeAdjust"
                                                             Width="50"
                                                             Text="{Binding Path=StepTimeAdjustMS, Mode=TwoWay, UpdateSourceTrigger=LostFocus,NotifyOnValidationError=True,ValidatesOnDataErrors=True}"
                                                             Validator:Validation.ValidationType="{x:Type System:Double}"
                                                             Validator:Validation.NoEmptyValue="True"
                                                             Validator:InputBindingsManager.UpdatePropertySourceWhenEnterPressed="TextBox.Text" />
                                                        <Button Width="30"
                                                            Content="✓">
                                                            <Button.Style>
                                                                <Style TargetType="Button">
                                                                    <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbStepTimeAdjust}"
                                                                                 Value="True">
                                                                            <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Button.Style>
                                                        </Button>
                                                        <Label Width="50"
                                                           Content="[ms]" />
                                                    </StackPanel>
                                                </StackPanel>
                                                <StackPanel Grid.Row="3"
                                                        Margin="1"
                                                        Orientation="Horizontal"
                                                        ToolTip="Z Flyback Time Adjustment in msec, positive or negative.">
                                                    <Label Width="150"
                                                       Content="Flyback Time Adjustment" />
                                                    <TextBox Name="tbFlybackTimeAdjust"
                                                         Width="50"
                                                         Text="{Binding Path=FlybackTimeAdjustMS, Mode=TwoWay, UpdateSourceTrigger=LostFocus,NotifyOnValidationError=True,ValidatesOnDataErrors=True}"
                                                         Validator:Validation.ValidationType="{x:Type System:Double}"
                                                         Validator:Validation.NoEmptyValue="True"
                                                         Validator:InputBindingsManager.UpdatePropertySourceWhenEnterPressed="TextBox.Text" />
                                                    <Button Width="30"
                                                        Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbFlybackTimeAdjust}"
                                                                             Value="True">
                                                                        <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                    <Label Width="50"
                                                       Content="[ms]" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                        <Grid x:Name="remoteFocusGrid"
                                              IsEnabled="{Binding ElementName=cbZFastEnable, Path=IsChecked}"
                                              Visibility="{Binding Path=IsRemoteFocus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource boolToVisibilityConverter}, ConverterParameter=0}">
                                            <Grid.Resources>
                                                <!--Template for the tick marks, every clickable position-->
                                                <DataTemplate x:Key="VerticalTick">
                                                    <Border Width="55" 
                                                            Height="13" 
                                                            CornerRadius="10" 
                                                            BorderThickness="2,0,0,2" 
                                                            BorderBrush="White">
                                                        <Border.Background>
                                                            <LinearGradientBrush StartPoint="0,0" 
                                                                                 EndPoint="0,1">
                                                                <GradientStop Offset="0" 
                                                                              Color="DarkGray"/>
                                                                <GradientStop Offset="1" 
                                                                              Color="Gray"/>
                                                            </LinearGradientBrush>
                                                        </Border.Background>
                                                        <Border.Effect>
                                                            <DropShadowEffect ShadowDepth="10" 
                                                                              Color="Black"
                                                                              Opacity="1" 
                                                                              BlurRadius="5"/>
                                                        </Border.Effect>
                                                        <Border.RenderTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform ScaleX="1" 
                                                                                ScaleY="1"/>
                                                                <SkewTransform AngleX="0" 
                                                                               AngleY="20"/>
                                                                <RotateTransform Angle="-20"/>
                                                            </TransformGroup>
                                                        </Border.RenderTransform>
                                                        <TextBlock Text="{Binding}" 
                                                                   TextWrapping="Wrap"
                                                                   Background="Transparent"
                                                                   Foreground="White" 
                                                                   VerticalAlignment="Center" 
                                                                   HorizontalAlignment="Center"
                                                                   FontSize="12" 
                                                                   FontWeight="Bold"/>
                                                    </Border>
                                                </DataTemplate>
                                                <!--Style for the slider track and base-->
                                                <Style x:Key="SliderBase" 
                                                       TargetType="ig:XamSliderBase">
                                                    <Setter Property="Orientation" 
                                                            Value="Vertical"/>
                                                    <Setter Property="IsMouseWheelEnabled" 
                                                            Value="False"/>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ig:XamSliderBase">
                                                                <Grid x:Name="RootElement" 
                                                                      Background="{TemplateBinding Background}">
                                                                    <VisualStateManager.VisualStateGroups>
                                                                        <VisualStateGroup x:Name="OrientationStates">
                                                                            <VisualState x:Name="Vertical"/>
                                                                        </VisualStateGroup>
                                                                    </VisualStateManager.VisualStateGroups>
                                                                    <Grid x:Name="VerticalSlider">
                                                                        <Grid x:Name="VerticalSlidersGrid" 
                                                                              Margin="20,0,0,0" 
                                                                              HorizontalAlignment="Right">
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="*"/>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                                <ColumnDefinition Width="*"/>
                                                                            </Grid.ColumnDefinitions>
                                                                        </Grid>
                                                                        <Grid x:Name="VerticalTickMarks" 
                                                                              Background="Transparent">
                                                                            <Border Width="43" 
                                                                                    Background="SteelBlue" 
                                                                                    Margin="3,0,0,0" 
                                                                                    Opacity="0.4" 
                                                                                    BorderBrush="Transparent"/>
                                                                        </Grid>
                                                                        <Grid x:Name="VerticalTrack" 
                                                                              Width="65" 
                                                                              Background="Transparent" 
                                                                              Margin="10,0,0,0">

                                                                            <Canvas x:Name="VerticalThumbs"/>
                                                                        </Grid>
                                                                    </Grid>
                                                                </Grid>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                                <Style x:Key="XamNumericRangeSliderStyle" 
                                                       BasedOn="{StaticResource SliderBase}" 
                                                       TargetType="ig:XamNumericRangeSlider">
                                                    <Setter Property="SmallChange" 
                                                            Value="1"/>
                                                    <Setter Property="LargeChange" 
                                                            Value="10"/>
                                                </Style>
                                                <!--Style for the start thumb-->
                                                <Style x:Key="StartThumbStyle"
                                                       TargetType="ig:XamSliderNumericThumb">
                                                    <Setter Property="IsSnapToTickEnabled" 
                                                            Value="true" />
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ig:XamSliderNumericThumb">
                                                                <StackPanel Orientation="Horizontal">
                                                                    <Border Width="56" 
                                                                            Height="13" 
                                                                            CornerRadius="10" 
                                                                            BorderBrush="Lime" 
                                                                            BorderThickness="2,0,0,2" >
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" 
                                                                                                 EndPoint="0,1">
                                                                                <GradientStop Offset="0" 
                                                                                              Color="LimeGreen"/>
                                                                                <GradientStop Offset="1" 
                                                                                              Color="DarkGreen"/>
                                                                            </LinearGradientBrush>
                                                                        </Border.Background>
                                                                        <Border.Effect>
                                                                            <DropShadowEffect ShadowDepth="10" 
                                                                                              Color="Black"
                                                                                              Opacity="1" 
                                                                                              BlurRadius="5"/>
                                                                        </Border.Effect>
                                                                        <Border.RenderTransform>
                                                                            <TransformGroup>
                                                                                <ScaleTransform ScaleX="1" 
                                                                                                ScaleY="1"/>
                                                                                <SkewTransform AngleX="0" 
                                                                                               AngleY="20"/>
                                                                                <RotateTransform Angle="-20"/>
                                                                            </TransformGroup>
                                                                        </Border.RenderTransform>
                                                                        <TextBlock Text="{Binding Value, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" 
                                                                                   TextWrapping="Wrap"
                                                                                   Background="Transparent"
                                                                                   Foreground="White" 
                                                                                   VerticalAlignment="Center" 
                                                                                   HorizontalAlignment="Center"
                                                                                   FontSize="12" 
                                                                                   FontWeight="Bold"/>
                                                                    </Border>
                                                                    <Grid Height="26"
                                                                          Width="47"
                                                                          Background="{x:Null}"
                                                                          HorizontalAlignment="Right"
                                                                          VerticalAlignment="Center" 
                                                                          Margin="8,1,-50,0">
                                                                        <Path Margin="-0.050933837890625,0,0,0"
                                                                              HorizontalAlignment="Left"
                                                                              VerticalAlignment="Top"
                                                                              Height="26"
                                                                              Width="47.050933837890625"
                                                                              Stretch="Fill"
                                                                              Opacity="1"
                                                                              Data="M 5,5 C5,5 5,7.85498046875 5,7.85498046875 5,7.85498046875 0.518524169921875,11.69842529296875 0.518524169921875,11.69842529296875 -0.240753173828125,12.349212646484375 -0.240753173828125,13.650787353515625 0.518524169921875,14.30157470703125 0.518524169921875,14.30157470703125 5,18.144989013671875 5,18.144989013671875 5,18.144989013671875 5,21 5,21 5,23.5 7.5,26 10,26 10,26 42,26 42,26 44.5,26 47,23.5 47,21 47,21 47,5 47,5 47,2.5 44.5,0 42,0 42,0 10,0 10,0 7.5,0 5,2.5 5,5 z"
                                                                              Fill="#999999" />
                                                                        <Grid VerticalAlignment="Center" 
                                                                              HorizontalAlignment="Center"
                                                                              Width="40"
                                                                              Margin="5,0,0,0">
                                                                            <Grid.ColumnDefinitions >
                                                                                <ColumnDefinition Width="26"/>
                                                                                <ColumnDefinition />
                                                                            </Grid.ColumnDefinitions>
                                                                            <TextBlock Text="Start"  
                                                                                       Grid.Column="0"
                                                                                       TextWrapping="Wrap" 
                                                                                       Foreground="White" 
                                                                                       HorizontalAlignment="Left" 
                                                                                       VerticalAlignment="Center" 
                                                                                       FontSize="11"/>
                                                                            <TextBlock Text="{Binding Value, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" 
                                                                                       Grid.Column="1"
                                                                                       TextWrapping="Wrap" 
                                                                                       Foreground="White" 
                                                                                       HorizontalAlignment="Left" 
                                                                                       VerticalAlignment="Center" 
                                                                                       FontSize="12" 
                                                                                       FontWeight="Bold"/>
                                                                        </Grid>
                                                                    </Grid>
                                                                </StackPanel>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                                <!--Style for the stop thumb-->
                                                <Style x:Key="StopThumbStyle"
                                                       TargetType="ig:XamSliderNumericThumb">
                                                    <Setter Property="IsSnapToTickEnabled" 
                                                            Value="true" />
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ig:XamSliderNumericThumb">
                                                                <StackPanel Orientation="Horizontal">
                                                                    <Border Width="56" 
                                                                            Height="13" 
                                                                            CornerRadius="10" 
                                                                            BorderBrush="Lime" 
                                                                            BorderThickness="2,0,0,2" >
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" 
                                                                                                 EndPoint="0,1">
                                                                                <GradientStop Offset="0" 
                                                                                              Color="LimeGreen"/>
                                                                                <GradientStop Offset="1" 
                                                                                              Color="DarkGreen"/>
                                                                            </LinearGradientBrush>
                                                                        </Border.Background>
                                                                        <Border.Effect>
                                                                            <DropShadowEffect ShadowDepth="10" 
                                                                                              Color="Black"
                                                                                              Opacity="1" 
                                                                                              BlurRadius="5"/>
                                                                        </Border.Effect>
                                                                        <Border.RenderTransform>
                                                                            <TransformGroup>
                                                                                <ScaleTransform ScaleX="1" 
                                                                                                ScaleY="1"/>
                                                                                <SkewTransform AngleX="0" 
                                                                                               AngleY="20"/>
                                                                                <RotateTransform Angle="-20"/>
                                                                            </TransformGroup>
                                                                        </Border.RenderTransform>
                                                                        <TextBlock Text="{Binding Value, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" 
                                                                                   TextWrapping="Wrap"
                                                                                   Background="Transparent"
                                                                                   Foreground="White" 
                                                                                   VerticalAlignment="Center" 
                                                                                   HorizontalAlignment="Center"
                                                                                   FontSize="12" 
                                                                                   FontWeight="Bold"/>
                                                                    </Border>
                                                                    <Grid Height="26"
                                                                          Width="47"
                                                                          Background="{x:Null}"
                                                                          HorizontalAlignment="Right"
                                                                          VerticalAlignment="Center" 
                                                                          Margin="8,1,-50,0">
                                                                        <Path Margin="-0.050933837890625,0,0,0"
                                                                              HorizontalAlignment="Left"
                                                                              VerticalAlignment="Top"
                                                                              Height="26"
                                                                              Width="47.050933837890625"
                                                                              Stretch="Fill"
                                                                              Opacity="1"
                                                                              Data="M 5,5 C5,5 5,7.85498046875 5,7.85498046875 5,7.85498046875 0.518524169921875,11.69842529296875 0.518524169921875,11.69842529296875 -0.240753173828125,12.349212646484375 -0.240753173828125,13.650787353515625 0.518524169921875,14.30157470703125 0.518524169921875,14.30157470703125 5,18.144989013671875 5,18.144989013671875 5,18.144989013671875 5,21 5,21 5,23.5 7.5,26 10,26 10,26 42,26 42,26 44.5,26 47,23.5 47,21 47,21 47,5 47,5 47,2.5 44.5,0 42,0 42,0 10,0 10,0 7.5,0 5,2.5 5,5 z"
                                                                              Fill="#999999" />
                                                                        <Grid VerticalAlignment="Center" 
                                                                              HorizontalAlignment="Center"
                                                                              Width="40"
                                                                              Margin="5,0,0,0">
                                                                            <Grid.ColumnDefinitions >
                                                                                <ColumnDefinition Width="26"/>
                                                                                <ColumnDefinition />
                                                                            </Grid.ColumnDefinitions>
                                                                            <TextBlock Text="Stop" 
                                                                                       Grid.Column="0"
                                                                                       TextWrapping="Wrap" 
                                                                                       Background="Transparent"
                                                                                       Foreground="White" 
                                                                                       HorizontalAlignment="Left" 
                                                                                       VerticalAlignment="Center" 
                                                                                       FontSize="11"/>
                                                                            <TextBlock Text="{Binding Value, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" 
                                                                                       Grid.Column="1"
                                                                                       TextWrapping="Wrap" 
                                                                                       Foreground="White" 
                                                                                       HorizontalAlignment="Left" 
                                                                                       VerticalAlignment="Center" 
                                                                                       FontSize="12" 
                                                                                       FontWeight="Bold"/>
                                                                        </Grid>
                                                                    </Grid>
                                                                </StackPanel>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                                <!--Style for the slider thumbs-->
                                                <Style x:Key="ThumbStyle"
                                                       TargetType="ig:XamSliderNumericThumb">
                                                    <Setter Property="IsSnapToTickEnabled" 
                                                            Value="true" />
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ig:XamSliderNumericThumb">
                                                                <StackPanel Orientation="Horizontal"
                                                                            Margin="0,-7,0,0">
                                                                    <Border Width="56" 
                                                                            Height="13" 
                                                                            CornerRadius="10" 
                                                                            BorderBrush="Lime" 
                                                                            BorderThickness="2,0,0,2" >
                                                                        <Border.Background>
                                                                            <LinearGradientBrush StartPoint="0,0" 
                                                                                                 EndPoint="0,1">
                                                                                <GradientStop Offset="0" 
                                                                                              Color="LimeGreen"/>
                                                                                <GradientStop Offset="1" 
                                                                                              Color="DarkGreen"/>
                                                                            </LinearGradientBrush>
                                                                        </Border.Background>
                                                                        <Border.Effect>
                                                                            <DropShadowEffect ShadowDepth="10" 
                                                                                              Color="Black"
                                                                                              Opacity="1" 
                                                                                              BlurRadius="5"/>
                                                                        </Border.Effect>
                                                                        <Border.RenderTransform>
                                                                            <TransformGroup>
                                                                                <ScaleTransform ScaleX="1" 
                                                                                                ScaleY="1"/>
                                                                                <SkewTransform AngleX="0" 
                                                                                               AngleY="20"/>
                                                                                <RotateTransform Angle="-20"/>
                                                                            </TransformGroup>
                                                                        </Border.RenderTransform>
                                                                        <TextBlock Text="{Binding Value, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" 
                                                                                   TextWrapping="Wrap"
                                                                                   Background="Transparent"
                                                                                   Foreground="White" 
                                                                                   VerticalAlignment="Center" 
                                                                                   HorizontalAlignment="Center"
                                                                                   FontSize="12" 
                                                                                   FontWeight="Bold"/>
                                                                    </Border>
                                                                </StackPanel>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </Grid.Resources>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="200"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0"
                                                        Margin="5,0,0,10">
                                                <Grid Height="320">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="70"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0"
                                                                HorizontalAlignment="Right">
                                                        <ItemsControl ItemsSource="{Binding DynamicLabels}">
                                                            <ItemsControl.ItemTemplate>
                                                                <DataTemplate>
                                                                    <TextBlock Text="{Binding StringFormat={}{0:F1} [um]}"  
                                                                               Foreground="White" 
                                                                               Margin="0,4,0,0"
                                                                               TextAlignment="Right"
                                                                               Background="Transparent"
                                                                               Width="70"
                                                                               HorizontalAlignment="Left" />
                                                                </DataTemplate>
                                                            </ItemsControl.ItemTemplate>
                                                        </ItemsControl>
                                                    </StackPanel>
                                                    <ig:XamNumericRangeSlider x:Name="remoteFocusSlider"
                                                                              Grid.Column="1"
                                                                              Height="300"
                                                                              MinValue="1"
                                                                              MaxValue="16"
                                                                              IsEnabled="True"
                                                                              Margin="-50,8,0,0"
                                                                              Orientation="Vertical"
                                                                              TrackFillBrush="Transparent"
                                                                              ThumbStyle="{StaticResource ThumbStyle}"
                                                                              Style="{StaticResource XamNumericRangeSliderStyle}"
                                                                              IsDirectionReversed="{Binding Path=ZInvert, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource boolToOppositeBoolConverter}}"
                                                                              HorizontalAlignment="Center"
                                                                              TrackClick="remoteFocusSlider_TrackClick"
                                                                              VerticalAlignment="Center">
                                                        <ig:XamNumericRangeSlider.TickMarks>
                                                            <ig:SliderTickMarks x:Name="rfTickMarks"
                                                                                IncludeSliderEnds="True" 
                                                                                UseFrequency="False"
                                                                                VerticalTickMarksTemplate="{StaticResource VerticalTick}"
                                                                                NumberOfTickMarks="{Binding RelativeSource={RelativeSource Self}, Path=Owner.DataContext.RemoteFocusNumberOfTicks}" />
                                                        </ig:XamNumericRangeSlider.TickMarks>
                                                        <ig:XamSliderNumericThumb x:Name="rfThumbStart"
                                                                                  InteractionMode="Free" 
                                                                                  IsActive="True" 
                                                                                  IsDragEnabled="True" 
                                                                                  IsManipulationEnabled="True" 
                                                                                  IsSnapToTickEnabled="True" 
                                                                                  IsTrackFillVisible="True"
                                                                                  ToolTipVisibility="Visible"
                                                                                  Margin="0,-14,0,0"
                                                                                  Style="{StaticResource StartThumbStyle}"
                                                                                  Value="{Binding Path=RemoteFocusStartPosition, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                                  Visibility="{Binding Path=RemoteFocusCaptureMode, Mode=OneWay, ConverterParameter=0, Converter={StaticResource storageModeVisibilityConverter}}">
                                                        </ig:XamSliderNumericThumb>
                                                        <ig:XamSliderNumericThumb x:Name="rfThumbStop"
                                                                                  InteractionMode="Free" 
                                                                                  IsActive="True" 
                                                                                  IsDragEnabled="True" 
                                                                                  IsManipulationEnabled="True" 
                                                                                  IsSnapToTickEnabled="True" 
                                                                                  IsTrackFillVisible="True"
                                                                                  ToolTipVisibility="Visible"
                                                                                  Margin="0,-14,0,0"
                                                                                  Style="{StaticResource StopThumbStyle}"
                                                                                  Value="{Binding Path=RemoteFocusStopPosition, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                                  Visibility="{Binding Path=RemoteFocusCaptureMode, Mode=OneWay, ConverterParameter=0, Converter={StaticResource storageModeVisibilityConverter}}">
                                                        </ig:XamSliderNumericThumb>
                                                    </ig:XamNumericRangeSlider>
                                                </Grid>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1"
                                                        VerticalAlignment="Top">
                                                <Label Content="Capture Mode"
                                                       Margin="0,55,0,0"/>
                                                <ComboBox Grid.Row="0"
                                                          Width="150"
                                                          Height="30"
                                                          Margin="5,1"
                                                          HorizontalAlignment="Left"
                                                          SelectedIndex="{Binding Path=RemoteFocusCaptureMode,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                          ToolTip="Choose Capture Mode for the Remote Focus"
                                                          SelectionChanged="RemoteFocusCB_SelectionChanged">
                                                    <ComboBoxItem>Linear</ComboBoxItem>
                                                    <ComboBoxItem>Custom</ComboBoxItem>
                                                </ComboBox>
                                                <Grid Visibility="{Binding Path=RemoteFocusCaptureMode, Mode=OneWay, ConverterParameter=0, Converter={StaticResource storageModeVisibilityConverter}}">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <StackPanel Grid.Row="0"
                                                            Margin="1"
                                                            Orientation="Horizontal"
                                                            ToolTip="Z Stack Start Plane">
                                                        <Label Width="120"
                                                           Content="Start Plane" />
                                                        <TextBox Name="tbZStartPlane"
                                                             Width="50"
                                                             Text="{Binding Path=RemoteFocusStartPosition, Mode=TwoWay}" />
                                                        <Button Width="30"
                                                            Content="✓">
                                                            <Button.Style>
                                                                <Style TargetType="Button">
                                                                    <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbZStartPlane}"
                                                                                 Value="True">
                                                                            <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Button.Style>
                                                        </Button>
                                                    </StackPanel>
                                                    <StackPanel Grid.Row="1"
                                                            Margin="1"
                                                            Orientation="Horizontal"
                                                            ToolTip="Z Stack Stop Plane">
                                                        <Label Width="120"
                                                               Content="Stop Plane" />
                                                        <TextBox Name="tbZStopPlane"
                                                                 Width="50"
                                                                 Foreground="White"
                                                                 Text="{Binding Path=RemoteFocusStopPosition, Mode=TwoWay}">
                                                            <TextBox.Style>
                                                                <Style TargetType="TextBox">
                                                                    <Style.Resources>
                                                                        <Storyboard x:Key="flashingAnimation">
                                                                            <DoubleAnimation AutoReverse="True"
                                                                                             Duration="0:0:0.5"
                                                                                             From="1"
                                                                                             RepeatBehavior="Forever"
                                                                                             Storyboard.TargetProperty="(Background).(Opacity)"
                                                                                             To="0.5" />
                                                                        </Storyboard>
                                                                    </Style.Resources>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Path=ZStopPositionNotValid}"
                                                                                     Value="True">
                                                                            <Setter Property="Background"
                                                                                    Value="Red" />
                                                                            <DataTrigger.EnterActions>
                                                                                <BeginStoryboard Name="flashing"
                                                                                                 Storyboard="{StaticResource flashingAnimation}" />
                                                                            </DataTrigger.EnterActions>
                                                                            <DataTrigger.ExitActions>
                                                                                <StopStoryboard BeginStoryboardName="flashing" />
                                                                            </DataTrigger.ExitActions>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding Path=ZStopPositionNotValid, UpdateSourceTrigger=PropertyChanged}"
                                                                                     Value="False">
                                                                            <Setter Property="Background"
                                                                                    Value="Transparent" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </TextBox.Style>
                                                        </TextBox>
                                                        <Button Width="30"
                                                            Content="✓">
                                                            <Button.Style>
                                                                <Style TargetType="Button">
                                                                    <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbZStopPlane}"
                                                                                 Value="True">
                                                                            <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Button.Style>
                                                        </Button>
                                                    </StackPanel>
                                                    <StackPanel Grid.Row="2"
                                                            Margin="1"
                                                            Orientation="Horizontal"
                                                            ToolTip="Z Slice Spacing">
                                                        <Label Width="120"
                                                           Content="Step Size" />
                                                        <TextBox Name="tbRFStepSize"
                                                             Width="50"
                                                             Text="{Binding Path=RemoteFocusStepSize, Mode=TwoWay}" />
                                                        <Button Width="30"
                                                            Content="✓">
                                                            <Button.Style>
                                                                <Style TargetType="Button">
                                                                    <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbRFStepSize}"
                                                                                 Value="True">
                                                                            <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Button.Style>
                                                        </Button>
                                                    </StackPanel>
                                                </Grid>
                                                <Grid Visibility="{Binding Path=RemoteFocusCaptureMode, Mode=OneWay, ConverterParameter=1, Converter={StaticResource storageModeVisibilityConverter}}">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    <TextBlock Grid.Row="0"
                                                               TextWrapping="Wrap"
                                                               Width="260"
                                                               HorizontalAlignment="Left"
                                                               Margin="5,0"
                                                               Text="Select the planes you want to image from the graph"
                                                               Foreground="White">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Visibility"
                                                                        Value="Visible" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsChecked, ElementName=cbCustomRF}"
                                                                                 Value="True">
                                                                        <Setter Property="Visibility"
                                                                                Value="Collapsed" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                    <CheckBox Grid.Row="1"
                                                              x:Name="cbCustomRF"
                                                              Margin="5"
                                                              Content="Enable Custom Order"
                                                              Checked="cbCustomRF_Checked"
                                                              Unchecked="cbCustomRF_Unchecked"
                                                              IsChecked="{Binding RemoteFocusCustomChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                    <StackPanel Grid.Row="2">
                                                        <StackPanel.Style>
                                                            <Style TargetType="StackPanel">
                                                                <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsChecked, ElementName=cbCustomRF}"
                                                                                 Value="True">
                                                                        <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </StackPanel.Style>
                                                        <TextBlock Text="Write the plane numbers, in the order you want to image, separated by ':'"
                                                                   TextWrapping="Wrap"
                                                                   HorizontalAlignment="Left"
                                                                   Margin="5,0"
                                                                   Width="260"/>
                                                        <TextBox HorizontalAlignment="Left"
                                                                 TextWrapping="Wrap"
                                                                 Margin="5"
                                                                 Height="50"
                                                                 Width="260"
                                                                 Text="{Binding RemoteFocusCustomOrder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                    </StackPanel>
                                                </Grid>
                                                <StackPanel Margin="1"
                                                            Orientation="Horizontal"
                                                            ToolTip="Z Transition Cycles">
                                                    <Label Width="120"
                                                           Content="Transition Cycles" />
                                                    <TextBox Name="tbRFFlybackLines"
                                                             Width="50"
                                                             Text="{Binding Path=FlybackLines, Mode=TwoWay, UpdateSourceTrigger=LostFocus}"
                                                             Validator:Validation.ValidationType="{x:Type System:Int32}"
                                                             Validator:Validation.NoEmptyValue="True"
                                                             Validator:Validation.MinValue="0"
                                                             Validator:InputBindingsManager.UpdatePropertySourceWhenEnterPressed="TextBox.Text" />
                                                    <Button Width="30"
                                                            Content="✓">
                                                        <Button.Style>
                                                            <Style TargetType="Button">
                                                                <Setter Property="Visibility"
                                                                        Value="Collapsed" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbRFFlybackLines}"
                                                                                 Value="True">
                                                                        <Setter Property="Visibility"
                                                                                Value="Visible" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Button.Style>
                                                    </Button>
                                                    <Label Content="{Binding Path=LSMFlybackTime}"
                                                           VerticalAlignment="Center" />
                                                    <Label Content="[s]"
                                                           VerticalAlignment="Center" />
                                                </StackPanel>
                                                <StackPanel Margin="1"
                                                            Orientation="Horizontal"
                                                            ToolTip="Total Number of Z Slices">
                                                    <Label Width="120"
                                                           Content="Number of Slices" />
                                                    <Label Width="50"
                                                           Content="{Binding Path=ZNumSteps, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </GroupBox>
                            </StackPanel>
                        </GroupBox>
                        <GroupBox Name="hyperspectralGroup"
                                  Margin="1"
                                  BorderBrush="White">
                            <GroupBox.Header>
                                <Label Content="Hyperspectral" />
                            </GroupBox.Header>
                            <StackPanel IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}">
                                <StackPanel Margin="1"
                                            Orientation="Horizontal"
                                            ToolTip="Hyperspectral capture start wavelength">
                                    <Label Width="120"
                                           Content="Start Wavelength" />
                                    <Label Name="lblStartWavelength"
                                           Width="35"
                                           HorizontalContentAlignment="Right"
                                           Content="{Binding Path=SFStartWavelength,
                                                                    Mode=TwoWay}" />
                                    <Label Width="120"
                                           Content="[nm]" />
                                </StackPanel>
                                <StackPanel Margin="1"
                                            Orientation="Horizontal"
                                            ToolTip="Hyperspectral capture stop wavelength">
                                    <Label Width="120"
                                           Content="Stop Wavelength" />
                                    <Label Name="lblStopWavelength"
                                           Width="35"
                                           HorizontalContentAlignment="Right"
                                           Content="{Binding Path=SFStopWavelength,
                                                                    Mode=TwoWay}" />
                                    <Label Width="120"
                                           Content="[nm]" />
                                </StackPanel>
                                <StackPanel Margin="1"
                                            Orientation="Horizontal"
                                            ToolTip="Hyperspectral capture wavelength step size">
                                    <Label Width="120"
                                           Content="Step Size" />
                                    <Label Name="lblStepSizeWavelength"
                                           Width="35"
                                           HorizontalContentAlignment="Right"
                                           Content="{Binding Path=SFWavelengthStepSize, 
                                                                    Mode=TwoWay}" />
                                    <Label Width="120"
                                           Content="[nm]" />
                                </StackPanel>
                                <StackPanel Margin="1"
                                            Orientation="Horizontal"
                                            ToolTip="Hyperspectral capture wavelength step size">
                                    <Label Width="120"
                                           Content="Number of Steps" />
                                    <Label Name="lblNumWavelengthSteps"
                                           HorizontalContentAlignment="Right"
                                           Width="35"
                                           Content="{Binding Path=SFSteps,
                                                                    Mode=TwoWay}" />
                                </StackPanel>
                                <StackPanel Margin="1">
                                    <ComboBox Width="150"
                                              Height="30"
                                              Margin="1"
                                              HorizontalAlignment="Left"
                                              SelectedIndex="{Binding Path=RawDataCapture,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                              ToolTip="Choose Output Data Format">
                                        <ComboBoxItem>TIFF</ComboBoxItem>
                                        <ComboBoxItem>RAW</ComboBoxItem>
                                        <ComboBoxItem>OME TIFF</ComboBoxItem>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                        <GroupBox Name="bleachingGroup"
                                  Visibility="{Binding Path=BleachOptionsVisibility}"
                                  IsEnabled="{Binding Path=StartButtonStatus, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                  Margin="1"
                                  BorderBrush="White">
                            <GroupBox.Header>
                                <Label Content="Stimulation" />
                            </GroupBox.Header>
                            <StackPanel>
                                <StackPanel HorizontalAlignment="Center"
                                            Orientation="Horizontal">
                                    <StackPanel Margin="1"
                                                Orientation="Vertical"
                                                ToolTip="Pre Bleach Frames">
                                        <Label Width="50"
                                               Content="" />
                                        <Label Width="80"
                                               HorizontalContentAlignment="Right"
                                               Content="Frames" />
                                        <Label Width="80"
                                               HorizontalContentAlignment="Right"
                                               Content="Interval [sec]" />
                                        <CheckBox Name="chkRawOption"
                                                  HorizontalAlignment="Right"
                                                  Content="Raw File"
                                                  Foreground="White"
                                                  Visibility="{Binding Path=ShowRawOption,
                                        Mode=TwoWay,
                                        UpdateSourceTrigger=PropertyChanged}"
                                                  IsChecked="{Binding Path=RawOption,
                                       Mode=TwoWay,
                                       UpdateSourceTrigger=PropertyChanged}" />
                                    </StackPanel>
                                    <Border>
                                        <StackPanel Margin="1"
                                                    Orientation="Vertical"
                                                    ToolTip="Pre stimulation imaging">
                                            <Label Width="90"
                                                   HorizontalAlignment="Left"
                                                   HorizontalContentAlignment="Center"
                                                   Content="Pre Stimulation" />
                                            <StackPanel Orientation="Horizontal">
                                                <TextBox Name="tbPreBleachFrames"
                                                         Width="50"
                                                         Margin="1"
                                                         Text="{Binding Path=PreBleachFrames,
                                                                        Mode=TwoWay}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbPreBleachFrames}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBox Name="tbPreBleachInterval"
                                                         Width="50"
                                                         Margin="1"
                                                         IsEnabled="{Binding Path=PreBleachStream,
                                                                             Mode=TwoWay,
                                                                             UpdateSourceTrigger=PropertyChanged,
                                                                             Converter={StaticResource bleachStreamEnableConverter}}"
                                                         Text="{Binding Path=PreBleachInterval,
                                                                        Mode=TwoWay,
                                                                        Converter={StaticResource doubleCulture}}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbPreBleachInterval}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <CheckBox Name="chkPreBleaching"
                                                      HorizontalAlignment="Left"
                                                      Content="Stream"
                                                      Foreground="White"
                                                      IsChecked="{Binding Path=PreBleachStream,
                                                                          Mode=TwoWay,
                                                                          UpdateSourceTrigger=PropertyChanged}" />
                                        </StackPanel>
                                    </Border>
                                    <Border>
                                        <StackPanel Margin="1"
                                                    Orientation="Vertical"
                                                    ToolTip="Stimulation">
                                            <Label Width="120"
                                                   HorizontalAlignment="Left"
                                                   HorizontalContentAlignment="Center"
                                                   Content="Stimulation Cycles" />
                                            <StackPanel Orientation="Horizontal">
                                                <StackPanel.Style>
                                                    <Style TargetType="StackPanel"
                                                            BasedOn="{StaticResource {x:Type StackPanel}}">
                                                        <Setter Property="Visibility"
                                                                Value="Visible" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=SelectedIndex, ElementName=cbBleachTrig, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         Value="3">
                                                                <Setter Property="Visibility"
                                                                        Value="Hidden" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </StackPanel.Style>
                                                <TextBox Name="tbBleachFrames"
                                                         Width="50"
                                                         Margin="1"
                                                         Text="{Binding Path=BleachFrames,
                                                                        Mode=TwoWay,
                                                                        UpdateSourceTrigger=PropertyChanged}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbBleachFrames}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                        Visibility="{Binding Path=IsStimulationIntervalVisible, Mode=OneWay, UpdateSourceTrigger=PropertyChanged, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}">
                                                <TextBox Name="tbBleachRepeatIdle"
                                                         Width="50"
                                                         Margin="1"
                                                         Text="{Binding Path=SLMBleachDelay,
                                                                        Mode=TwoWay,
                                                                        Converter={StaticResource doubleCulture}}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbBleachRepeatIdle}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <CheckBox Name="cbSimultaneousBleachingAndImaging"
                                                      Content="Simultaneous"
                                                      IsChecked="{Binding Path=SimultaneousBleachingAndImaging}"
                                                      Checked="cbSimultaneousBleachingAndImaging_Checked" />
                                            <ComboBox Name="cbBleachTrig"
                                                      Margin="1"
                                                      Width="100"
                                                      SelectedIndex="{Binding Path=BleachTrigger, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                      ToolTip="Select stimulation trigger mode.">
                                                <ComboBoxItem Content="SW Trigger"
                                                              Visibility="{Binding Path=IsChecked, ElementName=cbSimultaneousBleachingAndImaging, ConverterParameter=1, Converter={StaticResource boolToVisibilityConverter}}" />
                                                <ComboBoxItem Content="HW TrigFirst" />
                                                <ComboBoxItem Content="HW TrigEach" />
                                                <ComboBoxItem Content="HW TrigCont" />
                                            </ComboBox>
                                            <CheckBox Name="cbRandomEpochs"
                                                      Content="Random Epochs"
                                                      ToolTip="Select to randomize epochs every cycle."
                                                      IsChecked="{Binding Path=SLMRandomEpochs,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                <CheckBox.Style>
                                                    <Style TargetType="{x:Type CheckBox}"
                                                           BasedOn="{StaticResource {x:Type CheckBox}}">
                                                        <Setter Property="Visibility"
                                                                Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=SLMSequenceOn, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                                         Value="True">
                                                                <Setter Property="Visibility"
                                                                        Value="Visible" />
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </CheckBox.Style>
                                            </CheckBox>
                                            <StackPanel>
                                                <Label Content="Enable PMTs while stimulating" />
                                                <StackPanel Orientation="Horizontal">
                                                    <CheckBox Content="A"
                                                              Margin="1"
                                                              IsChecked="{Binding Path=PMT1EnableDuringBleach}" />
                                                    <CheckBox Content="B"
                                                              Margin="1"
                                                              IsChecked="{Binding Path=PMT2EnableDuringBleach}" />
                                                    <CheckBox Content="C"
                                                              Margin="1"
                                                              IsChecked="{Binding Path=PMT3EnableDuringBleach}" />
                                                    <CheckBox Content="D"
                                                              Margin="1"
                                                              IsChecked="{Binding Path=PMT4EnableDuringBleach}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                    <Border>
                                        <StackPanel Margin="1"
                                                    Orientation="Vertical"
                                                    ToolTip="Post stimulation 1st imaging">
                                            <Label Width="120"
                                                   HorizontalContentAlignment="Center"
                                                   Content="Post Stimulation 1"
                                                   Visibility="{Binding Path=IsChecked, ElementName=cbSimultaneousBleachingAndImaging, ConverterParameter=1, Converter={StaticResource boolToVisibilityConverter}}" />
                                            <Label Width="120"
                                                   HorizontalContentAlignment="Center"
                                                   Visibility="{Binding Path=IsChecked, ElementName=cbSimultaneousBleachingAndImaging, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}"
                                                   Content="Stimulation Imaging" />
                                            <StackPanel Orientation="Horizontal">
                                                <TextBox Name="tbPostBleachFrames1"
                                                         Width="50"
                                                         Margin="1"
                                                         Text="{Binding Path=PostBleachFrames1,
                                                                        Mode=TwoWay}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbPostBleachFrames1}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBox Name="tbPostBleachInterval1"
                                                         Width="50"
                                                         Margin="1"
                                                         IsEnabled="{Binding Path=PostBleachStream1,
                                                                             Mode=TwoWay,
                                                                             UpdateSourceTrigger=PropertyChanged,
                                                                             Converter={StaticResource bleachStreamEnableConverter}}"
                                                         Text="{Binding Path=PostBleachInterval1,
                                                                        Mode=TwoWay,
                                                                        Converter={StaticResource doubleCulture}}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbPostBleachInterval1}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <CheckBox Name="chkPostBleaching1"
                                                      Margin="1"
                                                      HorizontalAlignment="Left"
                                                      Content="Stream"
                                                      Foreground="White"
                                                      IsChecked="{Binding Path=PostBleachStream1,
                                                                          Mode=TwoWay,
                                                                          UpdateSourceTrigger=PropertyChanged}" />
                                            <ComboBox Name="cbImagTrig"
                                                      Width="100"
                                                      SelectedIndex="{Binding Path=BleachPostTrigger,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged}"
                                                      ToolTip="Select post bleach imaging trigger mode.">
                                                <ComboBoxItem Content="SW Trigger" />
                                                <ComboBoxItem Content="HW TrigFirst" />
                                            </ComboBox>
                                        </StackPanel>
                                    </Border>
                                    <Border>
                                        <StackPanel Margin="1"
                                                    Orientation="Vertical"
                                                    ToolTip="Post stimulation 2nd imaging">
                                            <Label Width="110"
                                                   HorizontalContentAlignment="Center"
                                                   Visibility="{Binding Path=IsChecked, ElementName=cbSimultaneousBleachingAndImaging, ConverterParameter=1, Converter={StaticResource boolToVisibilityConverter}}"
                                                   Content="Post Stimulation 2" />
                                            <Label HorizontalContentAlignment="Center"
                                                   Width="110"
                                                   Visibility="{Binding Path=IsChecked, ElementName=cbSimultaneousBleachingAndImaging, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}"
                                                   Content="Post Stimulation" />
                                            <StackPanel Orientation="Horizontal">
                                                <TextBox Name="tbPostBleachFrames2"
                                                         Width="50"
                                                         Margin="1"
                                                         Text="{Binding Path=PostBleachFrames2,
                                                                        Mode=TwoWay}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbPostBleachFrames2}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBox Name="tbPostBleachInterval2"
                                                         Width="50"
                                                         Margin="1"
                                                         IsEnabled="{Binding Path=PostBleachStream2,
                                                                             Mode=TwoWay,
                                                                             UpdateSourceTrigger=PropertyChanged,
                                                                             Converter={StaticResource bleachStreamEnableConverter}}"
                                                         Text="{Binding Path=PostBleachInterval2,
                                                                        Mode=TwoWay,
                                                                        Converter={StaticResource doubleCulture}}" />
                                                <Button Width="30"
                                                        Content="✓">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Visibility"
                                                                    Value="Collapsed" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Path=IsFocused, ElementName=tbPostBleachInterval2}"
                                                                             Value="True">
                                                                    <Setter Property="Visibility"
                                                                            Value="Visible" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                            <CheckBox Name="chkPostBleaching2"
                                                      HorizontalAlignment="Left"
                                                      Content="Stream"
                                                      Foreground="White"
                                                      IsChecked="{Binding Path=PostBleachStream2,
                                                                          Mode=TwoWay,
                                                                          UpdateSourceTrigger=PropertyChanged}" />
                                        </StackPanel>
                                    </Border>

                                </StackPanel>
                                <StackPanel HorizontalAlignment="Left"
                                            Visibility="{Binding Path=ZFastEnable, ConverterParameter=1, Converter={StaticResource boolToVisibilityConverter}}">
                                    <WrapPanel MaxWidth="500"
                                               Orientation="Horizontal"
                                               Visibility="{Binding Path=StopButtonStatus,
                                                                    ConverterParameter=0,
                                                                    Converter={StaticResource boolToVisibilityConverter}}">
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=Power0Visibility}">
                                            <Label Content="{Binding Path=PowerControlNames[0].Value}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content=":"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=Power0,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=Power1Visibility}">
                                            <Label Content="{Binding Path=PowerControlNames[1].Value}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content=":"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=Power1,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=Power2Visibility}">
                                            <Label Content="{Binding Path=PowerControlNames[2].Value}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content=":"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=Power2,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=Power3Visibility}">
                                            <Label Content="{Binding Path=PowerControlNames[3].Value}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content=":"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=Power3,
                                                                     Mode=OneWay,
                                                                     UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=Power4Visibility}">
                                            <Label Content="{Binding Path=PowerControlNames[4].Value}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content=":"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=Power4,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=Power5Visibility}">
                                            <Label Content="{Binding Path=PowerControlNames[5].Value}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content=":"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=Power5,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=MCLS1Visibility}">
                                            <Label Content="{Binding Path=MCLS1Name}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=MCLS1Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=MCLS2Visibility}">
                                            <Label Content="{Binding Path=MCLS2Name}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=MCLS2Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=MCLS3Visibility}">
                                            <Label Content="{Binding Path=MCLS3Name}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=MCLS3Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=MCLS4Visibility}">
                                            <Label Content="{Binding Path=MCLS4Name}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="{Binding Path=MCLS4Power,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                        </StackPanel>
                                        <StackPanel Margin="1"
                                                    Orientation="Horizontal"
                                                    Visibility="{Binding Path=PinholeVisibility}">
                                            <Label Content="Pinhole:"
                                                   FontSize="14"
                                                   Foreground="LimeGreen" />
                                            <Label Content="{Binding Path=PinholePosition,
                                                                                 Mode=OneWay,
                                                                                 UpdateSourceTrigger=PropertyChanged}"
                                                   FontSize="14"
                                                   Foreground="Lime" />
                                            <Label Content="[um]"
                                                   FontSize="14"
                                                   Foreground="LimeGreen" />
                                        </StackPanel>
                                    </WrapPanel>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                    </StackPanel>

                    <Border Name="xyBorder">
                        <Expander Margin="1"
                                  Foreground="White"
                                  Header="Tile Control"
                                  IsExpanded="True">
                            <StackPanel Orientation="Horizontal">
                                <Border Name="brdWell"
                                        Grid.Row="1"
                                        Grid.ColumnSpan="2">
                                    <xy:XYTileDisplay Name="tileControl"
                                                      ActiveXML="{Binding Path=ActiveExperimentPath,
                                                                          Mode=OneWay,
                                                                          UpdateSourceTrigger=PropertyChanged}"
                                                      ApplicationSettings="{Binding Path=ApplicationSettingPath,
                                                                                    Mode=OneWay,
                                                                                    UpdateSourceTrigger=PropertyChanged}"
                                                      MaxX="0"
                                                      MaxY="0"
                                                      MinX="0"
                                                      MinY="0"
                                                      Mode="Capture"
                                                      ScanAreaHeight="{Binding Path=FieldSizeHeightUM,
                                                                               Mode=OneWay,
                                                                               UpdateSourceTrigger=PropertyChanged}"
                                                      ScanAreaWidth="{Binding Path=FieldSizeWidthUM,
                                                                              Mode=OneWay,
                                                                              UpdateSourceTrigger=PropertyChanged}"
                                                      ScanAreaXPosition="{Binding Path=XPosition,
                                                                                  Mode=OneWay,
                                                                                  UpdateSourceTrigger=PropertyChanged}"
                                                      ScanAreaYPosition="{Binding Path=YPosition,
                                                                                  Mode=OneWay,
                                                                                  UpdateSourceTrigger=PropertyChanged}"
                                                      ScanAreaZPosition="{Binding Path=ZPosition,
                                                                                  Mode=OneWay,
                                                                                  UpdateSourceTrigger=PropertyChanged}"
                                                      XYtableData="{Binding Path=XYtableData, 
                                                                            Mode=TwoWay, 
                                                                            UpdateSourceTrigger=PropertyChanged}"
                                                      StepSizeX="0"
                                                      StepSizeY="0" />
                                </Border>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal"
                                                Visibility="{Binding Path=StopButtonStatus, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}">
                                        <Label Margin="1"
                                               HorizontalAlignment="Center"
                                               Content="X"
                                               FontSize="24"
                                               Foreground="Lime" />
                                        <Label Width="115"
                                               Margin="1"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Content="{Binding Path=XPosition,
                                                                 Mode=OneWay,
                                                                 UpdateSourceTrigger=PropertyChanged,
                                                                 Converter={StaticResource doubleCulture}}"
                                               FontSize="24"
                                               Foreground="Lime" />
                                        <Label Margin="1"
                                               HorizontalAlignment="Center"
                                               Content="[mm]"
                                               FontSize="24"
                                               Foreground="Lime" />

                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal"
                                                Visibility="{Binding Path=StopButtonStatus, ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}">
                                        <Label Margin="1"
                                               HorizontalAlignment="Center"
                                               Content="Y"
                                               FontSize="24"
                                               Foreground="Lime" />
                                        <Label Width="115"
                                               Margin="1"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               Content="{Binding Path=YPosition,
                                                                 Mode=OneWay,
                                                                 UpdateSourceTrigger=PropertyChanged,
                                                                 Converter={StaticResource doubleCulture}}"
                                               FontSize="24"
                                               Foreground="Lime" />
                                        <Label Margin="1"
                                               HorizontalAlignment="Center"
                                               Content="[mm]"
                                               FontSize="24"
                                               Foreground="Lime" />
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </Expander>
                    </Border>
                    <Border Name="dflimBorder">
                        <Expander Margin="1"
                                  Foreground="White"
                                  Header="Digital FLIM Control"
                                  IsExpanded="True">
                            <dflimControl:DFLIMControlUC x:Name="DFLIMControlView"
                                                         DFLIMTauLow="{Binding DFLIMTauLow}"
                                                         DFLIMTauHigh="{Binding DFLIMTauHigh}"
                                                         DFLIMLUTLow="{Binding DFLIMLUTLow}"
                                                         DFLIMLUTHigh="{Binding DFLIMLUTHigh}"
                                                         DFLIMTZero="{Binding DFLIMTZero}"
                                                         DFLIMDisplayLifetimeImage="{Binding DFLIMDisplayLifetimeImage}"
                                                         DFLIMHWControlsVisibility="{Binding DFLIMHWControlsVisibility}"
                                                         DFLIMHistogramCopyCounter="{Binding DFLIMHistogramCopyCounter, Mode=OneWay}"
                                                         DFLIMHistogramMVMDataLock="{Binding DFLIMHistogramMVMDataLock, Mode=OneWay}"
                                                         DFLIMHistogramDictionary="{Binding DFLIMHistogramDictionary, Mode=OneWay}" />
                        </Expander>
                    </Border>
                    <Border Name="mROIDisplay"
                    Margin="1">
                        <Expander Foreground="White" Header="mROI" IsExpanded="True">
                            <StackPanel Orientation="Vertical">
                                <GroupBox Header="Display" BorderThickness="0.5">
                                    <StackPanel>
                                        <RadioButton Content="Spatial Display" GroupName="CapturemROIDisplayType" Margin="3"
                         IsChecked="{Binding mROISpatialDisplaybleEnableCapture}" />
                                        <RadioButton Content="Only Scan ROIs" Margin="3"
                         GroupName="CapturemROIDisplayType"
                         IsChecked="False" />
                                    </StackPanel>
                                </GroupBox>

                                <StackPanel Orientation="Horizontal"
                        Margin="1"
                        HorizontalAlignment="Left" >
                                    <Label VerticalAlignment="Center"
                       Content="Stripe Pixels"/>

                                    <Label Name="tbStripPixel"
                         Width="35"
                       VerticalContentAlignment="Center"
                       VerticalAlignment="Center"
                       Content="{Binding Path=mROIStripePixels}" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="1"
                        HorizontalAlignment="Left" >
                                    <Label Content="Stripe Width" VerticalContentAlignment="Center"/>

                                    <Label Content="{Binding mROIStripePhysicalFieldSizeUM}"
                       VerticalContentAlignment="Center"
                       VerticalAlignment="Center" />
                                    <Label Content="[µm]" VerticalContentAlignment="Center" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal"
                                Margin="0"
                                VerticalAlignment="Center">
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Left">
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Setter Property="Visibility"
                                                    Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path=SelectedViewMode, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                                             Value="1">
                                                    <Setter Property="Visibility"
                                                            Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </StackPanel.Style>
                                </StackPanel>
                                <ListView Name="mROIListView"
                      Height="150"
                      Background="#FF333333"
                      Margin="1"
                      SelectedIndex="{Binding SelectedmROIIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                      ItemsSource="{Binding mROIList}"
                      SelectionMode="Single"
                      HorizontalContentAlignment="Center"                      
                      ToolTip="List of mROI Scan Areas"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="Focusable"
                                                    Value="True" />
                                            <Setter Property="HorizontalContentAlignment"
                                                    Value="Stretch" />
                                            <Setter Property="Background"
                                                    Value="#FF333333" />
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.Style>
                                        <Style TargetType="{x:Type ListView}">
                                            <Setter Property="HorizontalContentAlignment"
                                                    Value="Stretch" />
                                            <Setter Property="Background"
                                                    Value="#FF333333" />
                                        </Style>
                                    </ListView.Style>
                                    <ListView.View>
                                        <GridView AllowsColumnReorder="False">
                                            <GridViewColumn Header="ID"                                        
                                                            Width="Auto" >
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock x:Name="Txt" Text="{Binding ScanAreaID}" Foreground="{Binding Color}" FontWeight="Bold"  />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn Header="   Z&#x0a;(µm)"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding ZPosition, ConverterParameter=1000, Converter={StaticResource doubleCultureUnitConverter}}" />
                                            <GridViewColumn Header="P1"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding Path=Power0}" />
                                            <GridViewColumn Header=" Width&#x0a;(Pixels)"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding Path=SizeXPixels}" />
                                            <GridViewColumn Header="Height&#x0a;(Pixels)"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding Path=SizeYPixels}" />
                                            <GridViewColumn Header="Width&#x0a; (um)"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding Path=PhysicalSizeXUM, StringFormat={}{0:F1}}" />
                                            <GridViewColumn Header="Height&#x0a;  (um)"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding Path=PhysicalSizeYUM, StringFormat={}{0:F1}}" />
                                            <GridViewColumn Header="Left&#x0a;(um)"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding Path=LeftUM, StringFormat={}{0:F1}}" />
                                            <GridViewColumn Header="Top&#x0a;(um)"
                                                            Width="Auto"
                                                            DisplayMemberBinding="{Binding Path=TopUM, StringFormat={}{0:F1}}" />
                                            <!--<GridViewColumn Header="IntraROI&#x0a;Delay (ms)" Width="Auto"
                                        DisplayMemberBinding="{Binding Path=FlyToNextAreaLineCycles}" />-->
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                                <StackPanel Orientation="Horizontal"
                                            Margin="1"
                                            HorizontalAlignment="Center">
                                    <ToggleButton Name="tbCfgMicroView"
                                                  Margin="2,0"
                                                  Height="25"
                                                  HorizontalAlignment="Center"
                                                  ToolTip="ON to show Overlay ROIs, OFF to hide">
                                        <ToggleButton.Style>
                                            <Style TargetType="ToggleButton"
                                                   BasedOn="{StaticResource {x:Type ToggleButton}}">
                                                <Setter Property="IsChecked"
                                                        Value="{Binding Path=mROIShowOverlays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                <Setter Property="Content"
                                                        Value="Show Overlay ROIs" />
                                                <Style.Triggers>
                                                    <Trigger Property="IsChecked"
                                                             Value="True">
                                                        <Setter Property="Content"
                                                                Value="Hide Overlay ROIs" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ToggleButton.Style>
                                    </ToggleButton>
                                </StackPanel>
                            </StackPanel>
                        </Expander>
                    </Border>
                    <Border Name="advancedImageControlDisplay" Visibility="{Binding Path=AdvancedImageControlPanelVisibility}">
                        <Expander Foreground="White"
                          Header="Advanced Image Controls"
                          IsExpanded="False">
                            <StackPanel>
                                <Grid Margin="0,2,0,5" Visibility="{Binding Path=DisplayAspectRatioOptionVisibility}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0"
                                            HorizontalAlignment="Left"
                                            Orientation="Horizontal"
                                            ToolTip="Pixel aspect ratio X:Y">
                                        <Label Content="Pixel Aspect Ratio X:Y"
                                           Foreground="White" />
                                        <Label Content="1:"
                                           Foreground="White" 
                                           HorizontalContentAlignment="Right"
                                           HorizontalAlignment="Right"/>
                                        <Label Name="tbLSMScaleYScan"
                                             Width="Auto"
                                             MinWidth="15"
                                             MaxWidth="30"
                                             HorizontalContentAlignment="Left"
                                             HorizontalAlignment="Left"
                                             VerticalAlignment="Stretch" 
                                             VerticalContentAlignment="Center"
                                             Content="{Binding Path=PixelAspectRatioYScale,
                                                            Mode=TwoWay,
                                                            Converter={StaticResource doubleCulture}}" />
                                    </StackPanel>
                                    <CheckBox Grid.Column="1" VerticalAlignment="Center" Content="Display Aspect Ratio in Image" HorizontalAlignment="Left" IsChecked="{Binding Path=DisplayAspectRatio}"/>
                                </Grid>
                            </StackPanel>
                        </Expander>
                    </Border>
                    <Border>
                        <StackPanel Margin="1"
                                    IsEnabled="{Binding Path=StartButtonStatus, UpdateSourceTrigger=PropertyChanged}">
                            <StackPanel Margin="1"
                                        Orientation="Horizontal"
                                        ToolTip="Destination Directory for Experiment">
                                <Label Content="Output Path" />
                                <TextBox Width="Auto"
                                         MinWidth="150"
                                         MaxWidth="330"
                                         Text="{Binding Path=OutputPath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         ToolTip="{Binding Path=OutputPath, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" />
                                <Button Width="75"
                                        Click="Button_Click"
                                        Content="Browse" />
                            </StackPanel>
                            <StackPanel Margin="1"
                                        Orientation="Horizontal"
                                        ToolTip="Experiment Name">
                                <Label Content="Experiment Name" />
                                <TextBox Width="Auto"
                                         MinWidth="120"
                                         MaxWidth="300"
                                         Text="{Binding Path=ExperimentName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         ToolTip="Experiment name cannot contain numbers after the reserved character '_'"
                                         Validator:Validation.NoEmptyValue="True" />
                                <TextBox MaxWidth="55"
                                         MinWidth="35"
                                         Width="Auto"
                                         Text="{Binding Path=ExperimentIndex, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         ToolTip="Unique ending number for experiment name"
                                         Margin="10,0,0,0"
                                         IsReadOnly="True"
                                         HorizontalContentAlignment="Center">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox"
                                               BasedOn="{StaticResource {x:Type TextBox}}">
                                            <Style.Triggers>
                                                <Trigger Property="Text"
                                                         Value="">
                                                    <Setter Property="Visibility"
                                                            Value="Collapsed" />
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </StackPanel>
                            <StackPanel Margin="1"
                                        Orientation="Horizontal"
                                        ToolTip="Experiment Notes">
                                <Label Content="Experiment Notes" />
                                <TextBox Width="395"
                                         Height="70"
                                         AcceptsReturn="True"
                                         Text="{Binding Path=ExperimentNotes,
                                                        Mode=TwoWay,
                                                        UpdateSourceTrigger=PropertyChanged}"
                                         TextWrapping="Wrap" />
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    <Border Name="digOutputBorder"
                            Visibility="Collapsed">
                        <View:DigOutputSwitchControl x:Name="digOutputSwitchView" />
                    </Border>
                </StackPanel>
                <Grid Grid.Row="2"
                      Grid.Column="0"
                      Grid.ColumnSpan="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0"
                          Margin="1"
                          HorizontalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="110" />
                            <ColumnDefinition Width="110" />
                            <ColumnDefinition Width="110" />
                            <ColumnDefinition Width="175" />
                        </Grid.ColumnDefinitions>
                        <Button Name="btnStart"
                                Grid.Column="0"
                                Width="100"
                                Height="50"
                                Margin="0"
                                Command="{Binding Path=RunSampleLSStartCommand}"
                                Content="Start"
                                Foreground="#FFFFFFFF"
                                IsEnabled="{Binding Path=StartButtonStatus,
                                                    Mode=OneWay,
                                                    UpdateSourceTrigger=PropertyChanged}"
                                ToolTip="Start the experiment">
                            <Button.Background>
                                <LinearGradientBrush StartPoint="0.5,0"
                                                     EndPoint="0.5,1">
                                    <GradientStop Offset="0"
                                                  Color="#FF808080" />
                                    <GradientStop Offset="0.9"
                                                  Color="#FF595959" />
                                </LinearGradientBrush>
                            </Button.Background>
                        </Button>
                        <Button Name="btnStop"
                                Grid.Column="1"
                                Width="100"
                                Height="50"
                                Margin="0"
                                Command="{Binding Path=RunSampleLSStopCommand}"
                                Content="Stop"
                                Foreground="#FFFFFFFF"
                                IsEnabled="{Binding Path=StopButtonStatus,
                                                    Mode=OneWay,
                                                    UpdateSourceTrigger=PropertyChanged}"
                                ToolTip="Stop the experiment">
                            <Button.Background>
                                <LinearGradientBrush StartPoint="0.5,0"
                                                     EndPoint="0.5,1">
                                    <GradientStop Offset="0"
                                                  Color="#FF808080" />
                                    <GradientStop Offset="0.9"
                                                  Color="#FF595959" />
                                </LinearGradientBrush>
                            </Button.Background>
                        </Button>
                        <Button Name="btnStimulusSave"
                                Grid.Column="2"
                                Width="100"
                                Height="50"
                                Margin="0"
                                Command="{Binding Path=TriggerSaveCommand}"
                                Content="{Binding Path=StimulusSaveBtnDisplay,
                                                  Mode=OneWay,
                                                  UpdateSourceTrigger=PropertyChanged}"
                                Foreground="#FFFFFFFF"
                                IsEnabled="{Binding Path=StopButtonStatus,
                                                    Mode=OneWay,
                                                    UpdateSourceTrigger=PropertyChanged}"
                                ToolTip="Stop the experiment"
                                Visibility="Collapsed">
                            <!--  Visibility ="{Binding Path=StimulusStreamVis, Mode=OneWay,ConverterParameter=0, Converter={StaticResource boolToVisibilityConverter}}"  -->
                            <Button.Background>
                                <LinearGradientBrush StartPoint="0.5,0"
                                                     EndPoint="0.5,1">
                                    <GradientStop Offset="0"
                                                  Color="#FF808080" />
                                    <GradientStop Offset="0.9"
                                                  Color="#FF595959" />
                                </LinearGradientBrush>
                            </Button.Background>
                        </Button>
                        <StackPanel Grid.Column="3"
                                    Margin="1"
                                    Orientation="Vertical">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="22" />
                                    <RowDefinition Height="22" />
                                    <RowDefinition Height="22" />
                                </Grid.RowDefinitions>
                                <Button x:Name="OpenNewReviewer"
                                        Grid.Row="0"
                                        Margin="1"
                                        Width="168"
                                        VerticalAlignment="Bottom"
                                        VerticalContentAlignment="Bottom"
                                        HorizontalAlignment="Left"
                                        Click="OpenNewReviewer_Click"
                                        Content="Open Review Window"
                                        ToolTip="Open a new window to review a capture"
                                        IsEnabled="{Binding Path=StartButtonStatus,
                                                            Mode=OneWay,
                                                            UpdateSourceTrigger=PropertyChanged}" />
                                <CheckBox Margin="1"
                                          Grid.Row="1"
                                          Name="chkDisplayImage"
                                          HorizontalAlignment="Left"
                                          VerticalAlignment="Bottom"
                                          VerticalContentAlignment="Bottom"
                                          Foreground="#FFFFFFFF"
                                          Content="Update Image Viewer"
                                          IsChecked="{Binding Path=DisplayImage,
                                                              Mode=TwoWay,
                                                              UpdateSourceTrigger=PropertyChanged}"
                                          ToolTip="Enable / Disable updating the image viewer synchronously"
                                          Visibility="{Binding Path=ImageUpdaterVisibility,
                                                               Mode=TwoWay,
                                                               UpdateSourceTrigger=PropertyChanged}" />
                                <CheckBox Grid.Row="3"
                                          Margin="1"
                                          Content="Turn Off Monitors"
                                          VerticalAlignment="Bottom"
                                          VerticalContentAlignment="Bottom"
                                          IsChecked="{Binding Path=TurnOffMonitorsDuringCapture,
                                                              Mode=TwoWay,
                                                              UpdateSourceTrigger=PropertyChanged}"
                                          ToolTip="Option to turn off the monitors when capturing the experiment" />
                            </Grid>
                        </StackPanel>

                    </Grid>
                    <UniformGrid Grid.Row="4">
                        <TextBlock Height="Auto"
                                   Margin="1,5,1,1"
                                   HorizontalAlignment="Center"
                                   Foreground="#FFFFFFFF"
                                   Text="{Binding Path=DriveSpace,
                                                  Mode=OneWay,
                                                  UpdateSourceTrigger=PropertyChanged}"
                                   TextAlignment="Center" />
                    </UniformGrid>
                    <StackPanel Grid.Row="5"
                                HorizontalAlignment="Center"
                                Orientation="Horizontal"
                                Visibility="Collapsed">
                        <TextBlock Height="30"
                                   Margin="1"
                                   HorizontalAlignment="Center"
                                   Foreground="#FFFFFFFF"
                                   Text="{Binding Path=ExperimentNameProgress,
                                                  Mode=OneWay,
                                                  UpdateSourceTrigger=PropertyChanged}"
                                   TextAlignment="Center" />
                    </StackPanel>
                    <UniformGrid Grid.Row="6">
                        <StackPanel>
                            <TextBlock HorizontalAlignment="Center"
                                       Foreground="#FFFFFFFF"
                                       Text="{Binding Path=StatusMessage, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                       TextAlignment="Center" />
                            <TextBlock HorizontalAlignment="Center"
                                       Foreground="Yellow"
                                       Text="{Binding Path=AFStatusMessage, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                                       TextAlignment="Center" 
                                       FontWeight="DemiBold"
                                       Visibility="{Binding Path=AFStatusVisibility, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </UniformGrid>
                    <UniformGrid Grid.Row="7">
                        <ProgressBar Width="400"
                                     Height="50"
                                     Margin="1"
                                     Background="#FF808080"
                                     Maximum="100"
                                     Minimum="0"
                                     Value="{Binding Path=PercentComplete,
                                                     Mode=OneWay,
                                                     UpdateSourceTrigger=PropertyChanged}" />
                    </UniformGrid>
                    <UniformGrid Grid.Row="8">
                        <!--  Dummy Controls for binding purpose  -->
                        <Label Content="{Binding Path=CurrentImageCount,
                                                 Mode=OneWay,
                                                 UpdateSourceTrigger=PropertyChanged}"
                               Foreground="#FF595959"
                               Visibility="Hidden" />
                        <Label Content="{Binding Path=CurrentWellCount,
                                                 Mode=OneWay,
                                                 UpdateSourceTrigger=PropertyChanged}"
                               Foreground="#FF595959"
                               Visibility="Hidden" />
                        <Label Content="{Binding Path=CurrentSubImageCount,
                                                 Mode=OneWay,
                                                 UpdateSourceTrigger=PropertyChanged}"
                               Foreground="#FF595959"
                               Visibility="Hidden" />
                        <Label Content="{Binding Path=ButtonClickedIndex,
                                                 Mode=OneWay,
                                                 UpdateSourceTrigger=PropertyChanged}"
                               Foreground="#FF595959"
                               Visibility="Hidden" />
                        <Label Content="{Binding Path=MosaicButtonClickedIndex,
                                                 Mode=OneWay,
                                                 UpdateSourceTrigger=PropertyChanged}"
                               Foreground="#FF595959"
                               Visibility="Hidden" />
                    </UniformGrid>
                </Grid>
            </Grid>
        </StackPanel>
    </Grid>
</UserControl>
